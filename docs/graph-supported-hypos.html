<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Graphically supported hypotheses | Data Analysis and Visualization in R (IN2339)</title>
  <meta name="description" content="This book introduces concepts and skills that can help you tackle real-world data analysis challenges. It covers concepts from probability, statistical inference, linear regression and machine learning and helps you develop skills such as R programming, data wrangling with data.table, data visualization with ggplot2, file organization with UNIX/Linux shell, version control with GitHub, and reproducible document preparation with R markdown." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Graphically supported hypotheses | Data Analysis and Visualization in R (IN2339)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book introduces concepts and skills that can help you tackle real-world data analysis challenges. It covers concepts from probability, statistical inference, linear regression and machine learning and helps you develop skills such as R programming, data wrangling with data.table, data visualization with ggplot2, file organization with UNIX/Linux shell, version control with GitHub, and reproducible document preparation with R markdown." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Graphically supported hypotheses | Data Analysis and Visualization in R (IN2339)" />
  
  <meta name="twitter:description" content="This book introduces concepts and skills that can help you tackle real-world data analysis challenges. It covers concepts from probability, statistical inference, linear regression and machine learning and helps you develop skills such as R programming, data wrangling with data.table, data visualization with ggplot2, file organization with UNIX/Linux shell, version control with GitHub, and reproducible document preparation with R markdown." />
  



<meta name="date" content="2024-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="high-dimensional-visualizations.html"/>
<link rel="next" href="resampling-stat.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis and Visualization in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i>Datasets</a></li>
<li class="chapter" data-level="" data-path="feedback.html"><a href="feedback.html"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#data-science-what-and-why"><i class="fa fa-check"></i>Data Science: What and why?</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#what-you-will-learn-and-not-learn"><i class="fa fa-check"></i>What you will learn and not learn</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#the-r-language"><i class="fa fa-check"></i>The R language</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#course-overview"><i class="fa fa-check"></i>Course overview</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#complementary-reading"><i class="fa fa-check"></i>Complementary reading</a></li>
</ul></li>
<li class="part"><span><b>I Get</b></span></li>
<li class="chapter" data-level="1" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>1</b> R basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-basics.html"><a href="r-basics.html#rstudio"><i class="fa fa-check"></i><b>1.1</b> Rstudio</a></li>
<li class="chapter" data-level="1.2" data-path="r-basics.html"><a href="r-basics.html#first-steps-with-r"><i class="fa fa-check"></i><b>1.2</b> First steps with R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="r-basics.html"><a href="r-basics.html#objects"><i class="fa fa-check"></i><b>1.2.1</b> Objects</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-basics.html"><a href="r-basics.html#the-workspace"><i class="fa fa-check"></i><b>1.2.2</b> The workspace</a></li>
<li class="chapter" data-level="1.2.3" data-path="r-basics.html"><a href="r-basics.html#functions"><i class="fa fa-check"></i><b>1.2.3</b> Functions</a></li>
<li class="chapter" data-level="1.2.4" data-path="r-basics.html"><a href="r-basics.html#other-prebuilt-objects"><i class="fa fa-check"></i><b>1.2.4</b> Other prebuilt objects</a></li>
<li class="chapter" data-level="1.2.5" data-path="r-basics.html"><a href="r-basics.html#variable-names"><i class="fa fa-check"></i><b>1.2.5</b> Variable names</a></li>
<li class="chapter" data-level="1.2.6" data-path="r-basics.html"><a href="r-basics.html#reusing-scripts"><i class="fa fa-check"></i><b>1.2.6</b> Reusing scripts</a></li>
<li class="chapter" data-level="1.2.7" data-path="r-basics.html"><a href="r-basics.html#commenting-your-code"><i class="fa fa-check"></i><b>1.2.7</b> Commenting your code</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-basics.html"><a href="r-basics.html#data-types"><i class="fa fa-check"></i><b>1.3</b> Data types</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="r-basics.html"><a href="r-basics.html#data-frames"><i class="fa fa-check"></i><b>1.3.1</b> Data frames</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-basics.html"><a href="r-basics.html#examining-an-object"><i class="fa fa-check"></i><b>1.3.2</b> Examining an object</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-basics.html"><a href="r-basics.html#the-accessor"><i class="fa fa-check"></i><b>1.3.3</b> The accessor: <code>$</code></a></li>
<li class="chapter" data-level="1.3.4" data-path="r-basics.html"><a href="r-basics.html#vectors-numerics-characters-and-logical"><i class="fa fa-check"></i><b>1.3.4</b> Vectors: numerics, characters, and logical</a></li>
<li class="chapter" data-level="1.3.5" data-path="r-basics.html"><a href="r-basics.html#factors"><i class="fa fa-check"></i><b>1.3.5</b> Factors</a></li>
<li class="chapter" data-level="1.3.6" data-path="r-basics.html"><a href="r-basics.html#lists"><i class="fa fa-check"></i><b>1.3.6</b> Lists</a></li>
<li class="chapter" data-level="1.3.7" data-path="r-basics.html"><a href="r-basics.html#matrices"><i class="fa fa-check"></i><b>1.3.7</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-basics.html"><a href="r-basics.html#vectors"><i class="fa fa-check"></i><b>1.4</b> Vectors</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="r-basics.html"><a href="r-basics.html#creating-vectors"><i class="fa fa-check"></i><b>1.4.1</b> Creating vectors</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-basics.html"><a href="r-basics.html#names"><i class="fa fa-check"></i><b>1.4.2</b> Names</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-basics.html"><a href="r-basics.html#sequences"><i class="fa fa-check"></i><b>1.4.3</b> Sequences</a></li>
<li class="chapter" data-level="1.4.4" data-path="r-basics.html"><a href="r-basics.html#subsetting"><i class="fa fa-check"></i><b>1.4.4</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-basics.html"><a href="r-basics.html#coercion"><i class="fa fa-check"></i><b>1.5</b> Coercion</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="r-basics.html"><a href="r-basics.html#not-availables-na"><i class="fa fa-check"></i><b>1.5.1</b> Not availables (NA)</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-basics.html"><a href="r-basics.html#sorting"><i class="fa fa-check"></i><b>1.6</b> Sorting</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="r-basics.html"><a href="r-basics.html#sort"><i class="fa fa-check"></i><b>1.6.1</b> <code>sort</code></a></li>
<li class="chapter" data-level="1.6.2" data-path="r-basics.html"><a href="r-basics.html#order"><i class="fa fa-check"></i><b>1.6.2</b> <code>order</code></a></li>
<li class="chapter" data-level="1.6.3" data-path="r-basics.html"><a href="r-basics.html#max-and-which.max"><i class="fa fa-check"></i><b>1.6.3</b> <code>max</code> and <code>which.max</code></a></li>
<li class="chapter" data-level="1.6.4" data-path="r-basics.html"><a href="r-basics.html#rank"><i class="fa fa-check"></i><b>1.6.4</b> <code>rank</code></a></li>
<li class="chapter" data-level="1.6.5" data-path="r-basics.html"><a href="r-basics.html#beware-of-recycling"><i class="fa fa-check"></i><b>1.6.5</b> Beware of recycling</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="r-basics.html"><a href="r-basics.html#vector-arithmetics"><i class="fa fa-check"></i><b>1.7</b> Vector arithmetics</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="r-basics.html"><a href="r-basics.html#rescaling-a-vector"><i class="fa fa-check"></i><b>1.7.1</b> Rescaling a vector</a></li>
<li class="chapter" data-level="1.7.2" data-path="r-basics.html"><a href="r-basics.html#two-vectors"><i class="fa fa-check"></i><b>1.7.2</b> Two vectors</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="r-basics.html"><a href="r-basics.html#indexing"><i class="fa fa-check"></i><b>1.8</b> Indexing</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="r-basics.html"><a href="r-basics.html#subsetting-with-logicals"><i class="fa fa-check"></i><b>1.8.1</b> Subsetting with logicals</a></li>
<li class="chapter" data-level="1.8.2" data-path="r-basics.html"><a href="r-basics.html#logical-operators"><i class="fa fa-check"></i><b>1.8.2</b> Logical operators</a></li>
<li class="chapter" data-level="1.8.3" data-path="r-basics.html"><a href="r-basics.html#which"><i class="fa fa-check"></i><b>1.8.3</b> <code>which</code></a></li>
<li class="chapter" data-level="1.8.4" data-path="r-basics.html"><a href="r-basics.html#match"><i class="fa fa-check"></i><b>1.8.4</b> <code>match</code></a></li>
<li class="chapter" data-level="1.8.5" data-path="r-basics.html"><a href="r-basics.html#in"><i class="fa fa-check"></i><b>1.8.5</b> <code>%in%</code></a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="r-basics.html"><a href="r-basics.html#r-programming"><i class="fa fa-check"></i><b>1.9</b> R programming</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>2</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#data.tables"><i class="fa fa-check"></i><b>2.1</b> Data.tables</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-wrangling.html"><a href="data-wrangling.html#overview"><i class="fa fa-check"></i><b>2.1.1</b> Overview</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-wrangling.html"><a href="data-wrangling.html#creating-and-loading-tables"><i class="fa fa-check"></i><b>2.1.2</b> Creating and loading tables</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-wrangling.html"><a href="data-wrangling.html#inspecting-tables"><i class="fa fa-check"></i><b>2.1.3</b> Inspecting tables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#row-subsetting"><i class="fa fa-check"></i><b>2.2</b> Row subsetting</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-wrangling.html"><a href="data-wrangling.html#subsetting-rows-by-indices"><i class="fa fa-check"></i><b>2.2.1</b> Subsetting rows by indices</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-wrangling.html"><a href="data-wrangling.html#subsetting-rows-by-logical-conditions"><i class="fa fa-check"></i><b>2.2.2</b> Subsetting rows by logical conditions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-wrangling.html"><a href="data-wrangling.html#column-operations"><i class="fa fa-check"></i><b>2.3</b> Column operations</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#working-with-columns"><i class="fa fa-check"></i><b>2.3.1</b> Working with columns</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#column-operations-1"><i class="fa fa-check"></i><b>2.3.2</b> Column operations</a></li>
<li class="chapter" data-level="2.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#advanced-commands-apply-over-columns"><i class="fa fa-check"></i><b>2.3.3</b> Advanced commands: *apply() over columns</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-wrangling.html"><a href="data-wrangling.html#the-by-option"><i class="fa fa-check"></i><b>2.4</b> The ‘by’ option</a></li>
<li class="chapter" data-level="2.5" data-path="data-wrangling.html"><a href="data-wrangling.html#counting-occurences-with-.n"><i class="fa fa-check"></i><b>2.5</b> Counting occurences with <code>.N</code></a></li>
<li class="chapter" data-level="2.6" data-path="data-wrangling.html"><a href="data-wrangling.html#extending-tables"><i class="fa fa-check"></i><b>2.6</b> Extending tables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data-wrangling.html"><a href="data-wrangling.html#creating-new-columns-the-command"><i class="fa fa-check"></i><b>2.6.1</b> Creating new columns (the := command)</a></li>
<li class="chapter" data-level="2.6.2" data-path="data-wrangling.html"><a href="data-wrangling.html#advanced-multiple-assignments"><i class="fa fa-check"></i><b>2.6.2</b> Advanced: Multiple assignments</a></li>
<li class="chapter" data-level="2.6.3" data-path="data-wrangling.html"><a href="data-wrangling.html#copying-tables"><i class="fa fa-check"></i><b>2.6.3</b> Copying tables</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-wrangling.html"><a href="data-wrangling.html#summary"><i class="fa fa-check"></i><b>2.7</b> Summary</a></li>
<li class="chapter" data-level="2.8" data-path="data-wrangling.html"><a href="data-wrangling.html#data.table-resources"><i class="fa fa-check"></i><b>2.8</b> Data.table resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html"><i class="fa fa-check"></i><b>3</b> Tidy data and combining tables</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#motivation"><i class="fa fa-check"></i><b>3.1.1</b> Motivation</a></li>
<li class="chapter" data-level="3.1.2" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#datasets-used-in-this-chapter"><i class="fa fa-check"></i><b>3.1.2</b> Datasets used in this chapter</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#tidy-and-untidy-data"><i class="fa fa-check"></i><b>3.2</b> Tidy and untidy data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#definition-of-tidy-data"><i class="fa fa-check"></i><b>3.2.1</b> Definition of tidy data</a></li>
<li class="chapter" data-level="3.2.2" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#advantages-of-tidy-data"><i class="fa fa-check"></i><b>3.2.2</b> Advantages of tidy data</a></li>
<li class="chapter" data-level="3.2.3" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#common-signs-of-untidy-datasets"><i class="fa fa-check"></i><b>3.2.3</b> Common signs of untidy datasets</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#tidying-up-datasets"><i class="fa fa-check"></i><b>3.3</b> Tidying up datasets</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#melting-wide-to-long"><i class="fa fa-check"></i><b>3.3.1</b> Melting (wide to long)</a></li>
<li class="chapter" data-level="3.3.2" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#casting-long-to-wide"><i class="fa fa-check"></i><b>3.3.2</b> Casting (long to wide)</a></li>
<li class="chapter" data-level="3.3.3" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#separating-columns"><i class="fa fa-check"></i><b>3.3.3</b> Separating columns</a></li>
<li class="chapter" data-level="3.3.4" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#uniting-columns"><i class="fa fa-check"></i><b>3.3.4</b> Uniting columns</a></li>
<li class="chapter" data-level="3.3.5" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#advanced-columns-containing-sets-of-values"><i class="fa fa-check"></i><b>3.3.5</b> Advanced: Columns containing sets of values</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#concatenating-tables"><i class="fa fa-check"></i><b>3.4</b> Concatenating tables</a></li>
<li class="chapter" data-level="3.5" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#merging-tables"><i class="fa fa-check"></i><b>3.5</b> Merging tables</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#inner-merge"><i class="fa fa-check"></i><b>3.5.1</b> Inner merge</a></li>
<li class="chapter" data-level="3.5.2" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#outer-full-merge"><i class="fa fa-check"></i><b>3.5.2</b> Outer (full) merge</a></li>
<li class="chapter" data-level="3.5.3" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#left-merge"><i class="fa fa-check"></i><b>3.5.3</b> Left merge</a></li>
<li class="chapter" data-level="3.5.4" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#right-merge"><i class="fa fa-check"></i><b>3.5.4</b> Right merge</a></li>
<li class="chapter" data-level="3.5.5" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#merging-by-several-columns"><i class="fa fa-check"></i><b>3.5.5</b> Merging by several columns</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#tidy-not-unique"><i class="fa fa-check"></i><b>3.6</b> Tidy representations are not unique</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#alternative-tidy-forms-of-a-table"><i class="fa fa-check"></i><b>3.6.1</b> Alternative tidy forms of a table</a></li>
<li class="chapter" data-level="3.6.2" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#on-multiple-types-of-observational-units-in-the-same-table"><i class="fa fa-check"></i><b>3.6.2</b> On multiple types of observational units in the same table</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#summary-1"><i class="fa fa-check"></i><b>3.7</b> Summary</a></li>
<li class="chapter" data-level="3.8" data-path="tidy-data-and-combining-tables.html"><a href="tidy-data-and-combining-tables.html#tidy-data-resources"><i class="fa fa-check"></i><b>3.8</b> Tidy data resources</a></li>
</ul></li>
<li class="part"><span><b>II Look</b></span></li>
<li class="chapter" data-level="4" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html"><i class="fa fa-check"></i><b>4</b> Low dimensional visualizations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#why-plotting"><i class="fa fa-check"></i><b>4.1</b> Why plotting?</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#plot-vs-stat"><i class="fa fa-check"></i><b>4.1.1</b> Plotting versus summary statistics</a></li>
<li class="chapter" data-level="4.1.2" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#plot-debug"><i class="fa fa-check"></i><b>4.1.2</b> Plotting helps finding bugs in the data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#grammar-of-graphics"><i class="fa fa-check"></i><b>4.2</b> Grammar of graphics</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#components-of-the-layered-grammar"><i class="fa fa-check"></i><b>4.2.1</b> Components of the layered grammar</a></li>
<li class="chapter" data-level="4.2.2" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#defining-the-data-and-layers"><i class="fa fa-check"></i><b>4.2.2</b> Defining the data and layers</a></li>
<li class="chapter" data-level="4.2.3" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#mapping-of-aesthetics"><i class="fa fa-check"></i><b>4.2.3</b> Mapping of aesthetics</a></li>
<li class="chapter" data-level="4.2.4" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#facets-axes-and-labels"><i class="fa fa-check"></i><b>4.2.4</b> Facets, axes and labels</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#different-types-of-one--and-two-dimensional-plots"><i class="fa fa-check"></i><b>4.3</b> Different types of one- and two-dimensional plots</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#plots-for-one-single-continuous-variable"><i class="fa fa-check"></i><b>4.3.1</b> Plots for one single continuous variable</a></li>
<li class="chapter" data-level="4.3.2" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#plots-for-two-variables-one-continuous-one-discrete"><i class="fa fa-check"></i><b>4.3.2</b> Plots for two variables: one continuous, one discrete</a></li>
<li class="chapter" data-level="4.3.3" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#plots-for-two-continuous-variables"><i class="fa fa-check"></i><b>4.3.3</b> Plots for two continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#further-plots-for-low-dimensional-data"><i class="fa fa-check"></i><b>4.4</b> Further plots for low dimensional data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#plot-matrix"><i class="fa fa-check"></i><b>4.4.1</b> Plot matrix</a></li>
<li class="chapter" data-level="4.4.2" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#correlation-plot"><i class="fa fa-check"></i><b>4.4.2</b> Correlation plot</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#summary-2"><i class="fa fa-check"></i><b>4.5</b> Summary</a></li>
<li class="chapter" data-level="4.6" data-path="low-dimensional-visualizations.html"><a href="low-dimensional-visualizations.html#resources"><i class="fa fa-check"></i><b>4.6</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html"><i class="fa fa-check"></i><b>5</b> High dimensional visualizations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#notations"><i class="fa fa-check"></i><b>5.1</b> Notations</a></li>
<li class="chapter" data-level="5.2" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#data-matrix-preparation"><i class="fa fa-check"></i><b>5.2</b> Data matrix preparation</a></li>
<li class="chapter" data-level="5.3" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#heatmaps"><i class="fa fa-check"></i><b>5.3</b> Heatmaps</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#centering-and-scaling-variables"><i class="fa fa-check"></i><b>5.3.1</b> Centering and scaling variables</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#clustering"><i class="fa fa-check"></i><b>5.4</b> Clustering</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#k-means-clustering"><i class="fa fa-check"></i><b>5.4.1</b> K-Means clustering</a></li>
<li class="chapter" data-level="5.4.2" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#hclust"><i class="fa fa-check"></i><b>5.4.2</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="5.4.3" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#comparing-clusterings-with-the-rand-index"><i class="fa fa-check"></i><b>5.4.3</b> Comparing clusterings with the Rand index</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#dimensionality-reduction-with-pca"><i class="fa fa-check"></i><b>5.5</b> Dimensionality reduction with PCA</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#a-minimal-pca-from-2d-to-1d"><i class="fa fa-check"></i><b>5.5.1</b> A minimal PCA: From 2D to 1D</a></li>
<li class="chapter" data-level="5.5.2" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#pca-in-higher-dimensions"><i class="fa fa-check"></i><b>5.5.2</b> PCA in higher dimensions</a></li>
<li class="chapter" data-level="5.5.3" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#pca-in-r"><i class="fa fa-check"></i><b>5.5.3</b> PCA in R</a></li>
<li class="chapter" data-level="5.5.4" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#plotting-pca-results-in-r"><i class="fa fa-check"></i><b>5.5.4</b> Plotting PCA results in R</a></li>
<li class="chapter" data-level="5.5.5" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#pca-summary"><i class="fa fa-check"></i><b>5.5.5</b> PCA summary</a></li>
<li class="chapter" data-level="5.5.6" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#nonlinear-dimension-reduction"><i class="fa fa-check"></i><b>5.5.6</b> Nonlinear dimension reduction</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#discussion"><i class="fa fa-check"></i><b>5.6</b> Discussion</a></li>
<li class="chapter" data-level="5.7" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#summary-3"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
<li class="chapter" data-level="5.8" data-path="high-dimensional-visualizations.html"><a href="high-dimensional-visualizations.html#resources-1"><i class="fa fa-check"></i><b>5.8</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html"><i class="fa fa-check"></i><b>6</b> Graphically supported hypotheses</a>
<ul>
<li class="chapter" data-level="6.1" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#descriptive-vs.-associative-plots"><i class="fa fa-check"></i><b>6.1</b> Descriptive vs. associative plots</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#descriptive-plots"><i class="fa fa-check"></i><b>6.1.1</b> Descriptive plots</a></li>
<li class="chapter" data-level="6.1.2" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#associative-plots"><i class="fa fa-check"></i><b>6.1.2</b> Associative plots</a></li>
<li class="chapter" data-level="6.1.3" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#correctly-using-descriptive-and-associative-plots"><i class="fa fa-check"></i><b>6.1.3</b> Correctly using descriptive and associative plots</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#correlation-and-causation"><i class="fa fa-check"></i><b>6.2</b> Correlation and causation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#the-association-is-not-statistically-supported"><i class="fa fa-check"></i><b>6.2.1</b> The association is not statistically supported</a></li>
<li class="chapter" data-level="6.2.2" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#reversing-cause-and-effect"><i class="fa fa-check"></i><b>6.2.2</b> Reversing cause and effect</a></li>
<li class="chapter" data-level="6.2.3" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#the-association-is-induced-by-a-third-variable"><i class="fa fa-check"></i><b>6.2.3</b> The association is induced by a third variable</a></li>
<li class="chapter" data-level="6.2.4" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#simpsons-paradox"><i class="fa fa-check"></i><b>6.2.4</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#data-presentation-as-story-telling"><i class="fa fa-check"></i><b>6.3</b> Data presentation as story telling</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#what-is-a-story"><i class="fa fa-check"></i><b>6.3.1</b> What is a story?</a></li>
<li class="chapter" data-level="6.3.2" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#presentation-structure"><i class="fa fa-check"></i><b>6.3.2</b> Presentation structure</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#guidelines-for-coloring-in-data-visualization"><i class="fa fa-check"></i><b>6.4</b> Guidelines for coloring in data visualization</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#color-coding-in-r"><i class="fa fa-check"></i><b>6.4.1</b> Color coding in R</a></li>
<li class="chapter" data-level="6.4.2" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#general-rules-for-color-coding"><i class="fa fa-check"></i><b>6.4.2</b> General rules for color coding</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#general-dos-and-donts-in-data-visualization"><i class="fa fa-check"></i><b>6.5</b> General do’s and don’ts in data visualization</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#dos"><i class="fa fa-check"></i><b>6.5.1</b> Do’s</a></li>
<li class="chapter" data-level="6.5.2" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#donts"><i class="fa fa-check"></i><b>6.5.2</b> Don’ts</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#summary-4"><i class="fa fa-check"></i><b>6.6</b> Summary</a></li>
<li class="chapter" data-level="6.7" data-path="graph-supported-hypos.html"><a href="graph-supported-hypos.html#resources-2"><i class="fa fa-check"></i><b>6.7</b> Resources</a></li>
</ul></li>
<li class="part"><span><b>III Conclude</b></span></li>
<li class="chapter" data-level="7" data-path="resampling-stat.html"><a href="resampling-stat.html"><i class="fa fa-check"></i><b>7</b> Resampling-based Statistical Assessment</a>
<ul>
<li class="chapter" data-level="7.1" data-path="resampling-stat.html"><a href="resampling-stat.html#yeast-dataset"><i class="fa fa-check"></i><b>7.1</b> The yeast dataset</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="resampling-stat.html"><a href="resampling-stat.html#the-experiment"><i class="fa fa-check"></i><b>7.1.1</b> The experiment</a></li>
<li class="chapter" data-level="7.1.2" data-path="resampling-stat.html"><a href="resampling-stat.html#genotype"><i class="fa fa-check"></i><b>7.1.2</b> Genotype</a></li>
<li class="chapter" data-level="7.1.3" data-path="resampling-stat.html"><a href="resampling-stat.html#growth-rates"><i class="fa fa-check"></i><b>7.1.3</b> Growth rates</a></li>
<li class="chapter" data-level="7.1.4" data-path="resampling-stat.html"><a href="resampling-stat.html#genotype-growth-rate-association-in-maltose-at-a-specific-marker"><i class="fa fa-check"></i><b>7.1.4</b> Genotype-growth rate association in maltose at a specific marker</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="resampling-stat.html"><a href="resampling-stat.html#statistical-hypothesis-testing"><i class="fa fa-check"></i><b>7.2</b> Statistical hypothesis testing</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="resampling-stat.html"><a href="resampling-stat.html#permut-test-build-up"><i class="fa fa-check"></i><b>7.2.1</b> Permutation testing: An intuitive build-up</a></li>
<li class="chapter" data-level="7.2.2" data-path="resampling-stat.html"><a href="resampling-stat.html#concepts-of-statistical-hypothesis-testing"><i class="fa fa-check"></i><b>7.2.2</b> Concepts of Statistical Hypothesis Testing</a></li>
<li class="chapter" data-level="7.2.3" data-path="resampling-stat.html"><a href="resampling-stat.html#permutation-testing-formally"><i class="fa fa-check"></i><b>7.2.3</b> Permutation testing, formally</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="resampling-stat.html"><a href="resampling-stat.html#confidence-intervals-quantifying-uncertainty-in-parameter-estimates"><i class="fa fa-check"></i><b>7.3</b> Confidence intervals: Quantifying uncertainty in parameter estimates</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="resampling-stat.html"><a href="resampling-stat.html#repeating-experiments-to-quantify-uncertainty"><i class="fa fa-check"></i><b>7.3.1</b> Repeating experiments to quantify uncertainty</a></li>
<li class="chapter" data-level="7.3.2" data-path="resampling-stat.html"><a href="resampling-stat.html#simulating-repeated-experiments"><i class="fa fa-check"></i><b>7.3.2</b> Simulating repeated experiments</a></li>
<li class="chapter" data-level="7.3.3" data-path="resampling-stat.html"><a href="resampling-stat.html#quantifying-uncertainty-using-the-case-resampling-bootstrap"><i class="fa fa-check"></i><b>7.3.3</b> Quantifying uncertainty using the case resampling bootstrap</a></li>
<li class="chapter" data-level="7.3.4" data-path="resampling-stat.html"><a href="resampling-stat.html#confidence-intervals-formal-definition"><i class="fa fa-check"></i><b>7.3.4</b> Confidence Intervals: Formal definition</a></li>
<li class="chapter" data-level="7.3.5" data-path="resampling-stat.html"><a href="resampling-stat.html#visualizing-the-formal-definition-of-confidence-intervals"><i class="fa fa-check"></i><b>7.3.5</b> Visualizing the formal definition of Confidence Intervals</a></li>
<li class="chapter" data-level="7.3.6" data-path="resampling-stat.html"><a href="resampling-stat.html#hypothesis-testing-with-the-confidence-interval"><i class="fa fa-check"></i><b>7.3.6</b> Hypothesis testing with the Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="resampling-stat.html"><a href="resampling-stat.html#discussion-1"><i class="fa fa-check"></i><b>7.4</b> Discussion</a></li>
<li class="chapter" data-level="7.5" data-path="resampling-stat.html"><a href="resampling-stat.html#conclusion"><i class="fa fa-check"></i><b>7.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analytical-stat.html"><a href="analytical-stat.html"><i class="fa fa-check"></i><b>8</b> Analytical Statistical Assessment</a>
<ul>
<li class="chapter" data-level="8.1" data-path="analytical-stat.html"><a href="analytical-stat.html#motivation-hypothesis-testing-in-large-datasets"><i class="fa fa-check"></i><b>8.1</b> Motivation: Hypothesis testing in large datasets</a></li>
<li class="chapter" data-level="8.2" data-path="analytical-stat.html"><a href="analytical-stat.html#the-binomial-test-testing-hypotheses-for-a-single-binary-variable"><i class="fa fa-check"></i><b>8.2</b> The Binomial Test: testing hypotheses for a single binary variable</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="analytical-stat.html"><a href="analytical-stat.html#abstraction-tossing-a-coin"><i class="fa fa-check"></i><b>8.2.1</b> Abstraction: Tossing a coin</a></li>
<li class="chapter" data-level="8.2.2" data-path="analytical-stat.html"><a href="analytical-stat.html#computing-a-binomial-test-with-r"><i class="fa fa-check"></i><b>8.2.2</b> Computing a binomial test with R</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="analytical-stat.html"><a href="analytical-stat.html#fisher-test"><i class="fa fa-check"></i><b>8.3</b> Fisher’s exact test: Testing the association between two binary variables</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="analytical-stat.html"><a href="analytical-stat.html#permutation-testing-and-the-hypergeometric-distribution"><i class="fa fa-check"></i><b>8.3.1</b> Permutation testing and the hypergeometric distribution</a></li>
<li class="chapter" data-level="8.3.2" data-path="analytical-stat.html"><a href="analytical-stat.html#fishers-exact-test"><i class="fa fa-check"></i><b>8.3.2</b> Fisher’s exact test</a></li>
<li class="chapter" data-level="8.3.3" data-path="analytical-stat.html"><a href="analytical-stat.html#fishers-exact-test-in-r"><i class="fa fa-check"></i><b>8.3.3</b> Fisher’s exact test in R</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="analytical-stat.html"><a href="analytical-stat.html#testing-the-association-between-one-quantitative-and-one-binary-variable"><i class="fa fa-check"></i><b>8.4</b> Testing the association between one quantitative and one binary variable</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="analytical-stat.html"><a href="analytical-stat.html#the-t-test"><i class="fa fa-check"></i><b>8.4.1</b> The t-test</a></li>
<li class="chapter" data-level="8.4.2" data-path="analytical-stat.html"><a href="analytical-stat.html#wilcoxon-rank-sum-test-an-alternative-to-the-t-test-for-non-gaussian-data"><i class="fa fa-check"></i><b>8.4.2</b> Wilcoxon rank-sum test: An alternative to the t-test for non-Gaussian data</a></li>
<li class="chapter" data-level="8.4.3" data-path="analytical-stat.html"><a href="analytical-stat.html#why-bother-wilcox"><i class="fa fa-check"></i><b>8.4.3</b> Why bother with the Wilcoxon rank-sum test?</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="analytical-stat.html"><a href="analytical-stat.html#association-between-two-quantitative-variables"><i class="fa fa-check"></i><b>8.5</b> Association between two quantitative variables</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="analytical-stat.html"><a href="analytical-stat.html#the-pearson-correlation-test"><i class="fa fa-check"></i><b>8.5.1</b> The Pearson correlation test</a></li>
<li class="chapter" data-level="8.5.2" data-path="analytical-stat.html"><a href="analytical-stat.html#the-spearman-rank-correlation-test"><i class="fa fa-check"></i><b>8.5.2</b> The Spearman rank correlation test</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="analytical-stat.html"><a href="analytical-stat.html#testing-associations-of-two-variables-overview"><i class="fa fa-check"></i><b>8.6</b> Testing associations of two variables: Overview</a></li>
<li class="chapter" data-level="8.7" data-path="analytical-stat.html"><a href="analytical-stat.html#assessing-distributional-assumptions-with-q-q-plots"><i class="fa fa-check"></i><b>8.7</b> Assessing distributional assumptions with Q-Q Plots</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="analytical-stat.html"><a href="analytical-stat.html#limitations-of-histograms"><i class="fa fa-check"></i><b>8.7.1</b> Limitations of Histograms</a></li>
<li class="chapter" data-level="8.7.2" data-path="analytical-stat.html"><a href="analytical-stat.html#q-q-plots-comparing-empirical-to-theoretical-quantiles"><i class="fa fa-check"></i><b>8.7.2</b> Q-Q plots: Comparing empirical to theoretical quantiles</a></li>
<li class="chapter" data-level="8.7.3" data-path="analytical-stat.html"><a href="analytical-stat.html#typical-q-q-plots"><i class="fa fa-check"></i><b>8.7.3</b> Typical Q-Q plots</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="analytical-stat.html"><a href="analytical-stat.html#analytical-conf-int"><i class="fa fa-check"></i><b>8.8</b> Analytical Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="analytical-stat.html"><a href="analytical-stat.html#binomial-case"><i class="fa fa-check"></i><b>8.8.1</b> Binomial case</a></li>
<li class="chapter" data-level="8.8.2" data-path="analytical-stat.html"><a href="analytical-stat.html#confidence-intervals-in-r"><i class="fa fa-check"></i><b>8.8.2</b> Confidence intervals in R</a></li>
<li class="chapter" data-level="8.8.3" data-path="analytical-stat.html"><a href="analytical-stat.html#advanced-a-note-on-overlapping-confidence-intervals"><i class="fa fa-check"></i><b>8.8.3</b> Advanced: A note on overlapping confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="analytical-stat.html"><a href="analytical-stat.html#discussion-2"><i class="fa fa-check"></i><b>8.9</b> Discussion</a></li>
<li class="chapter" data-level="8.10" data-path="analytical-stat.html"><a href="analytical-stat.html#conclusion-1"><i class="fa fa-check"></i><b>8.10</b> Conclusion</a></li>
<li class="chapter" data-level="8.11" data-path="analytical-stat.html"><a href="analytical-stat.html#resources-3"><i class="fa fa-check"></i><b>8.11</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="big-data-stat.html"><a href="big-data-stat.html"><i class="fa fa-check"></i><b>9</b> Statistical Assessments for Big Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="big-data-stat.html"><a href="big-data-stat.html#motivation-statistical-significance-in-a-big-data-context"><i class="fa fa-check"></i><b>9.1</b> Motivation: Statistical Significance in a Big Data context</a></li>
<li class="chapter" data-level="9.2" data-path="big-data-stat.html"><a href="big-data-stat.html#effect-size-actually-important-or-just-significant"><i class="fa fa-check"></i><b>9.2</b> Effect Size: Actually important or just significant?</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="big-data-stat.html"><a href="big-data-stat.html#the-relationship-of-sample-size-and-significance"><i class="fa fa-check"></i><b>9.2.1</b> The relationship of sample size and significance</a></li>
<li class="chapter" data-level="9.2.2" data-path="big-data-stat.html"><a href="big-data-stat.html#report-p-value-effect-size-and-plot"><i class="fa fa-check"></i><b>9.2.2</b> Report <span class="math inline">\(P-\)</span>value, effect size, and plot</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="big-data-stat.html"><a href="big-data-stat.html#multiple-testing"><i class="fa fa-check"></i><b>9.3</b> Multiple Testing</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="big-data-stat.html"><a href="big-data-stat.html#multiple-testing-in-real-life-p-hacking-and-fishing-expeditions"><i class="fa fa-check"></i><b>9.3.1</b> Multiple testing in real life: <span class="math inline">\(P-\)</span>Hacking and fishing expeditions</a></li>
<li class="chapter" data-level="9.3.2" data-path="big-data-stat.html"><a href="big-data-stat.html#the-land-of-counterfeit-fake-coins"><i class="fa fa-check"></i><b>9.3.2</b> The Land of Counterfeit (fake) coins</a></li>
<li class="chapter" data-level="9.3.3" data-path="big-data-stat.html"><a href="big-data-stat.html#simulation"><i class="fa fa-check"></i><b>9.3.3</b> Simulation</a></li>
<li class="chapter" data-level="9.3.4" data-path="big-data-stat.html"><a href="big-data-stat.html#nominal-p-values"><i class="fa fa-check"></i><b>9.3.4</b> Nominal <span class="math inline">\(P-\)</span>values</a></li>
<li class="chapter" data-level="9.3.5" data-path="big-data-stat.html"><a href="big-data-stat.html#family-wise-error-rate"><i class="fa fa-check"></i><b>9.3.5</b> Family-wise error rate</a></li>
<li class="chapter" data-level="9.3.6" data-path="big-data-stat.html"><a href="big-data-stat.html#false-discovery-rate"><i class="fa fa-check"></i><b>9.3.6</b> False Discovery Rate</a></li>
<li class="chapter" data-level="9.3.7" data-path="big-data-stat.html"><a href="big-data-stat.html#overview-figure"><i class="fa fa-check"></i><b>9.3.7</b> Overview figure</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="big-data-stat.html"><a href="big-data-stat.html#conclusions"><i class="fa fa-check"></i><b>9.4</b> Conclusions</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="big-data-stat.html"><a href="big-data-stat.html#to-remember"><i class="fa fa-check"></i><b>9.4.1</b> To remember</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="big-data-stat.html"><a href="big-data-stat.html#references"><i class="fa fa-check"></i><b>9.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html"><i class="fa fa-check"></i><b>10</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#motivation-and-overview"><i class="fa fa-check"></i><b>10.1</b> Motivation and overview</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#testing-conditional-dependence"><i class="fa fa-check"></i><b>10.1.1</b> Testing conditional dependence</a></li>
<li class="chapter" data-level="10.1.2" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#linear-regression"><i class="fa fa-check"></i><b>10.1.2</b> Linear regression</a></li>
<li class="chapter" data-level="10.1.3" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#limitations"><i class="fa fa-check"></i><b>10.1.3</b> Limitations</a></li>
<li class="chapter" data-level="10.1.4" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#applications"><i class="fa fa-check"></i><b>10.1.4</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#univariate-regression"><i class="fa fa-check"></i><b>10.2</b> Univariate regression</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#galtons-height-dataset"><i class="fa fa-check"></i><b>10.2.1</b> Galton’s height dataset</a></li>
<li class="chapter" data-level="10.2.2" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#ML-LSE"><i class="fa fa-check"></i><b>10.2.2</b> Maximum likelihood and least squares estimates</a></li>
<li class="chapter" data-level="10.2.3" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#interpretation-of-the-fitted-coefficients"><i class="fa fa-check"></i><b>10.2.3</b> Interpretation of the fitted coefficients</a></li>
<li class="chapter" data-level="10.2.4" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#predicted-values-are-random-variables"><i class="fa fa-check"></i><b>10.2.4</b> Predicted values are random variables</a></li>
<li class="chapter" data-level="10.2.5" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#explained-variance"><i class="fa fa-check"></i><b>10.2.5</b> Explained variance</a></li>
<li class="chapter" data-level="10.2.6" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#testing-the-relationship-between-y-and-x"><i class="fa fa-check"></i><b>10.2.6</b> Testing the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#multivariate-regression"><i class="fa fa-check"></i><b>10.3</b> Multivariate regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#a-multivariate-example-the-baseball-dataset"><i class="fa fa-check"></i><b>10.3.1</b> A multivariate example: The baseball dataset</a></li>
<li class="chapter" data-level="10.3.2" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#fitting-multivariate-regression"><i class="fa fa-check"></i><b>10.3.2</b> Fitting multivariate regression</a></li>
<li class="chapter" data-level="10.3.3" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#testing-sets-of-parameters"><i class="fa fa-check"></i><b>10.3.3</b> Testing sets of parameters</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#lin-reg-diagnostic"><i class="fa fa-check"></i><b>10.4</b> Diagnostic plots</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#assessing-non-linearity-with-residual-plot"><i class="fa fa-check"></i><b>10.4.1</b> Assessing non-linearity with residual plot</a></li>
<li class="chapter" data-level="10.4.2" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#when-error-variance-is-not-constant-heteroscedascity"><i class="fa fa-check"></i><b>10.4.2</b> When error variance is not constant: Heteroscedascity</a></li>
<li class="chapter" data-level="10.4.3" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#gaussianity-q-q-plot-of-the-residuals"><i class="fa fa-check"></i><b>10.4.3</b> Gaussianity: Q-Q-plot of the residuals</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chap-lin-reg.html"><a href="chap-lin-reg.html#conclusions-1"><i class="fa fa-check"></i><b>10.5</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap-log-reg.html"><a href="chap-log-reg.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chap-log-reg.html"><a href="chap-log-reg.html#a-univariate-example-predicting-sex-given-the-height"><i class="fa fa-check"></i><b>11.1</b> A univariate example: predicting sex given the height</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="chap-log-reg.html"><a href="chap-log-reg.html#from-linear-regression-to-logistic-regression"><i class="fa fa-check"></i><b>11.1.1</b> From linear regression to logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="chap-log-reg.html"><a href="chap-log-reg.html#ML-CE"><i class="fa fa-check"></i><b>11.2</b> Maximum likelihood estimates and the cross-entropy criterion</a></li>
<li class="chapter" data-level="11.3" data-path="chap-log-reg.html"><a href="chap-log-reg.html#logistic-regression-as-a-generalized-linear-model"><i class="fa fa-check"></i><b>11.3</b> Logistic regression as a generalized linear model</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chap-log-reg.html"><a href="chap-log-reg.html#logistic-regression-with-r"><i class="fa fa-check"></i><b>11.3.1</b> Logistic regression with R</a></li>
<li class="chapter" data-level="11.3.2" data-path="chap-log-reg.html"><a href="chap-log-reg.html#overview-plot-of-the-univariate-example"><i class="fa fa-check"></i><b>11.3.2</b> Overview plot of the univariate example</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chap-log-reg.html"><a href="chap-log-reg.html#interpreting-a-logistic-regression-fit"><i class="fa fa-check"></i><b>11.4</b> Interpreting a logistic regression fit</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="chap-log-reg.html"><a href="chap-log-reg.html#predicted-odds"><i class="fa fa-check"></i><b>11.4.1</b> Predicted odds</a></li>
<li class="chapter" data-level="11.4.2" data-path="chap-log-reg.html"><a href="chap-log-reg.html#coefficients-of-the-logistic-regression"><i class="fa fa-check"></i><b>11.4.2</b> Coefficients of the logistic regression</a></li>
<li class="chapter" data-level="11.4.3" data-path="chap-log-reg.html"><a href="chap-log-reg.html#effects-on-probabilities"><i class="fa fa-check"></i><b>11.4.3</b> Effects on probabilities</a></li>
<li class="chapter" data-level="11.4.4" data-path="chap-log-reg.html"><a href="chap-log-reg.html#class-imbalance"><i class="fa fa-check"></i><b>11.4.4</b> Class imbalance</a></li>
<li class="chapter" data-level="11.4.5" data-path="chap-log-reg.html"><a href="chap-log-reg.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>11.4.5</b> Multiple Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="chap-log-reg.html"><a href="chap-log-reg.html#assessing-the-performance-of-a-classifier"><i class="fa fa-check"></i><b>11.5</b> Assessing the performance of a classifier</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="chap-log-reg.html"><a href="chap-log-reg.html#classification-with-logistic-regression"><i class="fa fa-check"></i><b>11.5.1</b> Classification with logistic regression</a></li>
<li class="chapter" data-level="11.5.2" data-path="chap-log-reg.html"><a href="chap-log-reg.html#confusion-matrix"><i class="fa fa-check"></i><b>11.5.2</b> Confusion Matrix</a></li>
<li class="chapter" data-level="11.5.3" data-path="chap-log-reg.html"><a href="chap-log-reg.html#classification-performance-metrics"><i class="fa fa-check"></i><b>11.5.3</b> Classification performance metrics</a></li>
<li class="chapter" data-level="11.5.4" data-path="chap-log-reg.html"><a href="chap-log-reg.html#choosing-a-classification-cutoff"><i class="fa fa-check"></i><b>11.5.4</b> Choosing a classification cutoff</a></li>
<li class="chapter" data-level="11.5.5" data-path="chap-log-reg.html"><a href="chap-log-reg.html#roc-curve"><i class="fa fa-check"></i><b>11.5.5</b> ROC curve</a></li>
<li class="chapter" data-level="11.5.6" data-path="chap-log-reg.html"><a href="chap-log-reg.html#precision-recall-curve"><i class="fa fa-check"></i><b>11.5.6</b> Precision Recall curve</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="chap-log-reg.html"><a href="chap-log-reg.html#conclusions-2"><i class="fa fa-check"></i><b>11.6</b> Conclusions</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="chap-log-reg.html"><a href="chap-log-reg.html#to-remember-1"><i class="fa fa-check"></i><b>11.6.1</b> To remember</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>12</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="supervised-learning.html"><a href="supervised-learning.html#introduction-3"><i class="fa fa-check"></i><b>12.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="supervised-learning.html"><a href="supervised-learning.html#motivation-2"><i class="fa fa-check"></i><b>12.1.1</b> Motivation</a></li>
<li class="chapter" data-level="12.1.2" data-path="supervised-learning.html"><a href="supervised-learning.html#supervised-learning-vs.-unsupervised-learning"><i class="fa fa-check"></i><b>12.1.2</b> Supervised learning vs. unsupervised learning</a></li>
<li class="chapter" data-level="12.1.3" data-path="supervised-learning.html"><a href="supervised-learning.html#notation"><i class="fa fa-check"></i><b>12.1.3</b> Notation</a></li>
<li class="chapter" data-level="12.1.4" data-path="supervised-learning.html"><a href="supervised-learning.html#basic-approach-in-supervised-machine-learning"><i class="fa fa-check"></i><b>12.1.4</b> Basic approach in supervised machine learning</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="supervised-learning.html"><a href="supervised-learning.html#over--and-under-fitting"><i class="fa fa-check"></i><b>12.2</b> Over- and Under-fitting</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="supervised-learning.html"><a href="supervised-learning.html#example-polynomial-curve-fitting"><i class="fa fa-check"></i><b>12.2.1</b> Example: polynomial curve fitting</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="supervised-learning.html"><a href="supervised-learning.html#splitting-the-dataset-for-performance-assessment"><i class="fa fa-check"></i><b>12.3</b> Splitting the dataset for performance assessment</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="supervised-learning.html"><a href="supervised-learning.html#over-fitting-to-the-training-dataset"><i class="fa fa-check"></i><b>12.3.1</b> Over-fitting to the training dataset</a></li>
<li class="chapter" data-level="12.3.2" data-path="supervised-learning.html"><a href="supervised-learning.html#cross-validation"><i class="fa fa-check"></i><b>12.3.2</b> Cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forests-as-alternative-models"><i class="fa fa-check"></i><b>12.4</b> Random Forests as alternative models</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="supervised-learning.html"><a href="supervised-learning.html#the-basics-of-decision-trees"><i class="fa fa-check"></i><b>12.4.1</b> The basics of decision trees</a></li>
<li class="chapter" data-level="12.4.2" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forests-for-classification-and-regression-tasks"><i class="fa fa-check"></i><b>12.4.2</b> Random Forests for classification and regression tasks</a></li>
<li class="chapter" data-level="12.4.3" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forests-in-r"><i class="fa fa-check"></i><b>12.4.3</b> Random Forests in R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="supervised-learning.html"><a href="supervised-learning.html#conclusion-2"><i class="fa fa-check"></i><b>12.5</b> Conclusion</a></li>
<li class="chapter" data-level="12.6" data-path="supervised-learning.html"><a href="supervised-learning.html#resources-4"><i class="fa fa-check"></i><b>12.6</b> Resources</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>A</b> Importing data</a>
<ul>
<li class="chapter" data-level="A.1" data-path="importing-data.html"><a href="importing-data.html#paths-and-the-working-directory"><i class="fa fa-check"></i><b>A.1</b> Paths and the working directory</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="importing-data.html"><a href="importing-data.html#the-filesystem"><i class="fa fa-check"></i><b>A.1.1</b> The filesystem</a></li>
<li class="chapter" data-level="A.1.2" data-path="importing-data.html"><a href="importing-data.html#relative-and-full-paths"><i class="fa fa-check"></i><b>A.1.2</b> Relative and full paths</a></li>
<li class="chapter" data-level="A.1.3" data-path="importing-data.html"><a href="importing-data.html#the-working-directory"><i class="fa fa-check"></i><b>A.1.3</b> The working directory</a></li>
<li class="chapter" data-level="A.1.4" data-path="importing-data.html"><a href="importing-data.html#generating-path-names"><i class="fa fa-check"></i><b>A.1.4</b> Generating path names</a></li>
<li class="chapter" data-level="A.1.5" data-path="importing-data.html"><a href="importing-data.html#copying-files-using-paths"><i class="fa fa-check"></i><b>A.1.5</b> Copying files using paths</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="importing-data.html"><a href="importing-data.html#the-readr-and-readxl-packages"><i class="fa fa-check"></i><b>A.2</b> The readr and readxl packages</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="importing-data.html"><a href="importing-data.html#readr"><i class="fa fa-check"></i><b>A.2.1</b> readr</a></li>
<li class="chapter" data-level="A.2.2" data-path="importing-data.html"><a href="importing-data.html#readxl"><i class="fa fa-check"></i><b>A.2.2</b> readxl</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="importing-data.html"><a href="importing-data.html#exercises"><i class="fa fa-check"></i><b>A.3</b> Exercises</a></li>
<li class="chapter" data-level="A.4" data-path="importing-data.html"><a href="importing-data.html#downloading-files"><i class="fa fa-check"></i><b>A.4</b> Downloading files</a></li>
<li class="chapter" data-level="A.5" data-path="importing-data.html"><a href="importing-data.html#r-base-importing-functions"><i class="fa fa-check"></i><b>A.5</b> R-base importing functions</a>
<ul>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html#scan"><i class="fa fa-check"></i><code>scan</code></a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="importing-data.html"><a href="importing-data.html#text-versus-binary-files"><i class="fa fa-check"></i><b>A.6</b> Text versus binary files</a></li>
<li class="chapter" data-level="A.7" data-path="importing-data.html"><a href="importing-data.html#unicode-versus-ascii"><i class="fa fa-check"></i><b>A.7</b> Unicode versus ASCII</a></li>
<li class="chapter" data-level="A.8" data-path="importing-data.html"><a href="importing-data.html#organizing-data-with-spreadsheets"><i class="fa fa-check"></i><b>A.8</b> Organizing data with spreadsheets</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html"><i class="fa fa-check"></i><b>B</b> R programming</a>
<ul>
<li class="chapter" data-level="B.1" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html#pipe"><i class="fa fa-check"></i><b>B.1</b> The pipe operator</a></li>
<li class="chapter" data-level="B.2" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html#conditionals"><i class="fa fa-check"></i><b>B.2</b> Conditional expressions</a></li>
<li class="chapter" data-level="B.3" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html#defining-functions"><i class="fa fa-check"></i><b>B.3</b> Defining functions</a></li>
<li class="chapter" data-level="B.4" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html#namespaces"><i class="fa fa-check"></i><b>B.4</b> Namespaces</a></li>
<li class="chapter" data-level="B.5" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html#for-loops"><i class="fa fa-check"></i><b>B.5</b> For-loops</a></li>
<li class="chapter" data-level="B.6" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html#vectorization"><i class="fa fa-check"></i><b>B.6</b> Vectorization and functionals</a></li>
<li class="chapter" data-level="B.7" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html#r-markdown"><i class="fa fa-check"></i><b>B.7</b> R Markdown</a></li>
<li class="chapter" data-level="B.8" data-path="appendix-r-programming.html"><a href="appendix-r-programming.html#resources-5"><i class="fa fa-check"></i><b>B.8</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="additonal-plotting-tools.html"><a href="additonal-plotting-tools.html"><i class="fa fa-check"></i><b>C</b> Additonal plotting tools</a>
<ul>
<li class="chapter" data-level="C.1" data-path="additonal-plotting-tools.html"><a href="additonal-plotting-tools.html#plotting-themes"><i class="fa fa-check"></i><b>C.1</b> Plotting themes</a></li>
<li class="chapter" data-level="C.2" data-path="additonal-plotting-tools.html"><a href="additonal-plotting-tools.html#axes"><i class="fa fa-check"></i><b>C.2</b> Axes</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="additonal-plotting-tools.html"><a href="additonal-plotting-tools.html#axis-elements"><i class="fa fa-check"></i><b>C.2.1</b> Axis elements</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="additonal-plotting-tools.html"><a href="additonal-plotting-tools.html#plot-title"><i class="fa fa-check"></i><b>C.3</b> Plot title</a></li>
<li class="chapter" data-level="C.4" data-path="additonal-plotting-tools.html"><a href="additonal-plotting-tools.html#legend"><i class="fa fa-check"></i><b>C.4</b> Legend</a></li>
<li class="chapter" data-level="C.5" data-path="additonal-plotting-tools.html"><a href="additonal-plotting-tools.html#interactive-plots"><i class="fa fa-check"></i><b>C.5</b> Interactive plots</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="appendix-probabilities.html"><a href="appendix-probabilities.html"><i class="fa fa-check"></i><b>D</b> Probabilities</a>
<ul>
<li class="chapter" data-level="D.1" data-path="appendix-probabilities.html"><a href="appendix-probabilities.html#probability-conditional-probability-and-dependence"><i class="fa fa-check"></i><b>D.1</b> Probability, conditional probability, and dependence</a></li>
<li class="chapter" data-level="D.2" data-path="appendix-probabilities.html"><a href="appendix-probabilities.html#expected-value-variance-and-covariance"><i class="fa fa-check"></i><b>D.2</b> Expected value, variance, and covariance</a></li>
<li class="chapter" data-level="D.3" data-path="appendix-probabilities.html"><a href="appendix-probabilities.html#probs-sample-estimates"><i class="fa fa-check"></i><b>D.3</b> Sample estimates</a></li>
<li class="chapter" data-level="D.4" data-path="appendix-probabilities.html"><a href="appendix-probabilities.html#appendix-lin-reg"><i class="fa fa-check"></i><b>D.4</b> Linear regression</a></li>
<li class="chapter" data-level="D.5" data-path="appendix-probabilities.html"><a href="appendix-probabilities.html#resources-6"><i class="fa fa-check"></i><b>D.5</b> Resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="./">Julien Gagneur, TUM</a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization in R (IN2339)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graph-supported-hypos" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Graphically supported hypotheses<a href="graph-supported-hypos.html#graph-supported-hypos" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the last 2 chapters we presented the different types of plots. We now consider the task of structuring and presenting an entire analysis. We want to be able to provide novel insights from a dataset. Guided by the scientific method, a major aspect will be to give strong support for testable hypotheses. This is important in basic research to suggest experimental validations (does this gene affect growth?), but also for decision makers in public health (does smoking cause cancer?), public governance (would investing in education benefit economy?) or in the industry (would modifying a process increase productivity, modifying a product increases sales, etc.?).</p>
<p>This chapter covers:</p>
<ul>
<li><p>the concepts of descriptive plots for data exploration, and associative plots to support testable hypotheses</p></li>
<li><p>how correlation and causation relate to each other</p></li>
<li><p>good practices to organize reports and presentations and to have visuals to convey one’s main message</p></li>
</ul>
<div id="descriptive-vs.-associative-plots" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Descriptive vs. associative plots<a href="graph-supported-hypos.html#descriptive-vs.-associative-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A typical data analysis starts with an exploration of the data. These are illustrated with descriptive plots showing how the data is distributed. This allows the audience and oneself to get familiar with the dataset in an unbiased fashion (e.g. number of participants in study, age and sex distributions). Afterwards, one typically highlights some interesting relationships between variables, often in order to suggest a testable, causal relationship. We call the latter types of plots associative plots.</p>
<div id="descriptive-plots" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Descriptive plots<a href="graph-supported-hypos.html#descriptive-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Descriptive plots allow exploring how a variable or a set of variables distribute. For a univariate data these are histograms, single boxplots or violin plots. For multivariate data these are clustered heatmaps, PCA projections, etc.</p>
<p>Descriptive plots correspond to descriptions of the distribution <span class="math inline">\(p(X)\)</span>, where <span class="math inline">\(X\)</span> is the variable we want to explore. In machine learning terms, they correspond to methods from unsupervised learning, e.g. k-means clustering, hierarchical clustering, PCA.</p>
<p>As an example, we can consider the <code>diamonds</code> dataset which contains the prices and other attributes of several diamonds. To first visualize the distribution of the weights (<code>carat</code>) of the diamonds, we can build a histogram:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="graph-supported-hypos.html#cb442-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span> mytheme</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/carat-distrib-1.png" width="672" /></p>
</div>
<div id="associative-plots" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Associative plots<a href="graph-supported-hypos.html#associative-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Associative plots show how a variable depends on another variable.</p>
<p>For such plots, one typically uses the y-axis for the response variable (e.g. survival rate, skin cancer occurrence) and the x-axis for the explanatory variables (e.g drug dose, sun exposure). Suitable plots are side-by-side boxplots, scatter plots, etc.</p>
<p>Associative plots are graphical representation of the conditional distributions <span class="math inline">\(p(y|x)\)</span> (pronounced “p of y given x”), where <span class="math inline">\(y\)</span> is the response and <span class="math inline">\(x\)</span> is the explanatory variable(s). When the conditional distribution <span class="math inline">\(p(y|x)\)</span> actually depends on <span class="math inline">\(x\)</span>, we say that <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are dependent. For instance, a scatterplot can show the trend that the response <span class="math inline">\(y\)</span> increases on average as <span class="math inline">\(x\)</span> increases. A boxplot can show that characteristic values of the distribution of <span class="math inline">\(y\)</span> (quartiles, median) depend on the value of the category <span class="math inline">\(x\)</span>, etc.</p>
<p>In machine learning terms, associative plots correspond to methods from supervised learning (e.g. regression, classification). For instance, one can build a predictor that predicts the risk of skin cancer <strong>given</strong> the age and sun exposure of a person.</p>
<p>Based on the same <code>diamonds</code> dataset, we can now construct an associative plot to graphically support the hypothesis that the price of a diamond increases with increasing weight (carat):</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="graph-supported-hypos.html#cb443-1" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(carat, price)) <span class="sc">+</span> </span>
<span id="cb443-2"><a href="graph-supported-hypos.html#cb443-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span> <span class="co"># alpha: point transparency</span></span>
<span id="cb443-3"><a href="graph-supported-hypos.html#cb443-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>() <span class="sc">+</span> mytheme</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:price-vs-carat"></span>
<img src="dataviz_book_files/figure-html/price-vs-carat-1.png" alt="Price increases nearly linearly with carat" width="384" />
<p class="caption">
Figure 6.1: Price increases nearly linearly with carat
</p>
</div>
</div>
<div id="correctly-using-descriptive-and-associative-plots" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Correctly using descriptive and associative plots<a href="graph-supported-hypos.html#correctly-using-descriptive-and-associative-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Claims are often not well supported with descriptive plots. For instance, claiming that “The experiments are reproducible because the replicate samples group together on the projection of the first PCA 2D-plane” is wrong. PCA is a visualization designed to capture the joint distribution of all data and not to assess reproducibility between given pair of samples. Instead claims are better supported using associative plots between an appropriate response variable on the y-axis against an appropriate dependent variable on the x-axis. In this example, we want to claim that there is a higher similarity between replicate experiments than across experiments from different conditions. To this end, one can create a boxplot that shows the distribution of the correlation between pairs of samples (y-axis) for two categories (x-axis): pairs of replicate samples and pairs of sample from different conditions.</p>
<!-- TODO: add a concrete example. the latter one makes sense for biologists in omics applications, probably not very concrete for others-->
</div>
</div>
<div id="correlation-and-causation" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Correlation and causation<a href="graph-supported-hypos.html#correlation-and-causation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One goal of data analysis is to provide a hypothesis about the underlying causal mechanisms.</p>
<p>Causal conclusions can be established in specific cases where the data has been gathered in a controlled fashion. This includes experimental perturbations where a single variable is changed and every other condition is kept the same. For instance, one can vary the dose of a drug given to a bacteria and measure its growth, in otherwise identical growth conditions. Randomized controlled trials constitute another example where a treatment and its placebo are administered to a cohort randomly, therefore preventing by design associations with other factors.</p>
<p>However, most of the time, we have access to observational data, i.e data sampled without the possibility to control the conditions. With observational data, we can assess statistical dependencies, or associations, between variables such as correlations, enrichments, etc. However, these do not necessarily imply a causal link.</p>
<p>In the following sections, we go through the elementary situations of non-causal associations and how to address these issues through data visualization and appropriate wordings of the claims. These are:</p>
<ul>
<li>The association is not statistically supported</li>
<li>The causal relationship is reverse</li>
<li>The association is induced by a third variable</li>
</ul>
<p>Associations between variables that are not due to a causal relationship are sometimes called “spurious correlations”. We prefer however to not use the term spurious correlation because genuine statistical dependencies that are non-causal are widespread. It is not the correlations that are spurious, but their causal interpretation.</p>
<div id="the-association-is-not-statistically-supported" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> The association is not statistically supported<a href="graph-supported-hypos.html#the-association-is-not-statistically-supported" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often, the observed association between variables arose by chance. Would the data collection be repeated, or performed for a longer period of time, the association would not show up any longer. There are two main reasons for this:</p>
<ol style="list-style-type: decimal">
<li><p>The association is driven by few data points. Graphically showing all data points including outliers can help (See Anscombe’s quartet <a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>). Hypothesis testing can be used to assess this possibility (See next Chapters).</p></li>
<li><p>The dataset includes so many variables that the chance to have one pair of variables associating is high. This is generally called data dredging, data fishing, data snooping, or cherry picking. An example of data dredging would be if we look through many results produced by a random process and pick the one that shows a relationship that supports a theory we want to defend. An example is given in Figure <a href="graph-supported-hypos.html#fig:missamerica-murder">6.2</a>.</p></li>
</ol>
<p>In the statistical literature, this problem is called “multiple testing”. It will be treated in a later chapter.</p>
<div class="figure"><span style="display:block;" id="fig:missamerica-murder"></span>
<img src="assets/img/lec06_tylervigen_missamerica_murders.png" alt="Example of a correlation discovered in a dataset with a very large set of variables. Source: http://www.tylervigen.com/spurious-correlations."  />
<p class="caption">
Figure 6.2: Example of a correlation discovered in a dataset with a very large set of variables. Source: <a href="http://www.tylervigen.com/spurious-correlations" class="uri">http://www.tylervigen.com/spurious-correlations</a>.
</p>
</div>
</div>
<div id="reversing-cause-and-effect" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Reversing cause and effect<a href="graph-supported-hypos.html#reversing-cause-and-effect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now assume the association did not arise by chance. Unlike causal relationships, statistical dependencies are symmetric (if A correlates with B, then B correlates with A). Hence, a typical mistake are claims where cause and effects are reversed.</p>
<p>A form of this claim actually made it into an op-ed in the New York Times titled Parental Involvement Is Overrated<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>. Consider this quote from the article:</p>
<blockquote>
<blockquote>
<p>When we examined whether regular help with homework had a positive impact on children’s academic performance, we were quite startled by what we found. Regardless of a family’s social class, racial or ethnic background, or a child’s grade level, consistent homework help almost never improved test scores or grades… Even more surprising to us was that when parents regularly helped with homework, kids usually performed worse.</p>
</blockquote>
</blockquote>
<p>In fact, a very likely possibility is that the children needing regular parental help receive this help because they do not perform well in school.</p>
<p>Further examples of reversing cause and effect include the following statements:</p>
<ul>
<li>People with healthier diet have higher blood pressure.</li>
<li>Individuals in a low social status have a higher risk of schizophrenia.</li>
<li>The number of fire engines on a fire associates with higher damages.</li>
<li>Entering an intensive care unit increases your chances of dying.</li>
</ul>
<p>There is no firm way to decide the direction of causality from a mere association. It is therefore important to consider and discuss both possibilities when interpreting a correlation.</p>
</div>
<div id="the-association-is-induced-by-a-third-variable" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> The association is induced by a third variable<a href="graph-supported-hypos.html#the-association-is-induced-by-a-third-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another general issue is when an association is due to a third variable. There are several scenarios.</p>
<p>Given two variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, we will now consider three basic configurations where a third variable <span class="math inline">\(z\)</span> could be causally related to them and how this affects associations between the variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> (Figure <a href="graph-supported-hypos.html#fig:causal-diagrams">6.3</a>). We show causal relationships using causal diagrams where variables are nodes and causal links are depicted as directed arrows. We denote <span class="math inline">\(x \perp y\)</span> when variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are statistically independent and <span class="math inline">\(x \not\perp y\)</span> when they are dependent. Also, <span class="math inline">\((x \perp y) | z\)</span> means that <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are independent given <span class="math inline">\(z\)</span>.</p>
<div class="figure"><span style="display:block;" id="fig:causal-diagrams"></span>
<img src="assets/img/lec06_causal_diagrams.png" alt="Elementary causal diagrams involving two variables of interest X and Y and a third variable Z."  />
<p class="caption">
Figure 6.3: Elementary causal diagrams involving two variables of interest X and Y and a third variable Z.
</p>
</div>
<div id="common-cause" class="section level4 hasAnchor" number="6.2.3.1">
<h4><span class="header-section-number">6.2.3.1</span> Common cause<a href="graph-supported-hypos.html#common-cause" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The statistical dependency between two variables can be due to a common cause. For instance, it had been reported that among students, smokers had higher university degrees than non-smokers. This association was due to student age as a common cause. With time, students are more likely to have started smoking and to have advanced further in their studies.</p>
<p>Plots can help to identify such situations. One can stratify by age and show that this positive association vanishes. This rules out a causal association because a causal association is expected to hold for all ages (or at least at some age).</p>
<!-- ### Confounding   -->
<!-- <!-- add circularity, natural and artificial confounders -->
<!-- Correlations are often driven by confounding factors. Depending on the context, this can lead to spurious associations and false interpretations. Exemplary, we can think about the negative correlation between tea drinking and lung cancer, as reported by observational studies: -->
<!-- ```{r,  out.width = "150px", echo=FALSE} -->
<!-- knitr::include_graphics("assets/img/lecture-06-confound1.png") -->
<!-- ``` -->
<!-- We can ask ourselves the question, what is "wrong" with the negative correlation between tea drinking and lung cancer. We consider that smokers are generally not tea drinkers but seem to prefer coffee. Smoking is causally related to lung cancer. Hence, we can investigate whether lung cancer and tea drinking are confounded by smoking status. -->
<!-- ```{r,  out.width = "150px", echo=FALSE} -->
<!-- knitr::include_graphics("assets/img/lecture-06-confound2.png") -->
<!-- ``` -->
<!-- Formally, a confounding variable (e.g. smoking status) is a variable that influences both the dependent variable (e.g. lung cancer) and independent variable (e.g. drinking tea status), causing a spurious association. Confounding has been described as a confusion of effects. In other words, the effect of the variable of interest on the outcome is confused with the effect of another factor on the outcome. To draw appropriate conclusions, we must separate its causal effect from that of the confounding factors. -->
<p>To understand the situation we will now generate artificially a dataset where two random variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> share a common cause <span class="math inline">\(z\)</span>.</p>
<p>We consider the following process:</p>
<ol style="list-style-type: decimal">
<li>We toss a fair coin twice and record <span class="math inline">\(z\)</span> the number of heads obtained. <span class="math inline">\(z\)</span> is thus equal to 0,1, or 2.</li>
<li>We draw a value <span class="math inline">\(x\)</span> randomly according to a Gaussian distribution with mean equals to <span class="math inline">\(z\)</span> and standard deviation 1. Hence, <span class="math inline">\(x\)</span> will be a random real number that tend to have higher values with higher values of <span class="math inline">\(z\)</span>.</li>
<li>We draw a value <span class="math inline">\(y\)</span> randomly according to a Gaussian distribution with mean equals to <span class="math inline">\(2 \times z\)</span> and standard deviation 1. Hence <span class="math inline">\(y\)</span> will be a random real number that tend to have higher values with higher values of <span class="math inline">\(z\)</span>.</li>
</ol>
<p>We then repeat this process <span class="math inline">\(n=1,000\)</span> times.</p>
<p>In R this can done with the following code:</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="graph-supported-hypos.html#cb444-1" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb444-2"><a href="graph-supported-hypos.html#cb444-2" tabindex="-1"></a><span class="do">## common cause</span></span>
<span id="cb444-3"><a href="graph-supported-hypos.html#cb444-3" tabindex="-1"></a><span class="do">## x &lt;- z -&gt; y</span></span>
<span id="cb444-4"><a href="graph-supported-hypos.html#cb444-4" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb444-5"><a href="graph-supported-hypos.html#cb444-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb444-6"><a href="graph-supported-hypos.html#cb444-6" tabindex="-1"></a></span>
<span id="cb444-7"><a href="graph-supported-hypos.html#cb444-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># number of draws</span></span>
<span id="cb444-8"><a href="graph-supported-hypos.html#cb444-8" tabindex="-1"></a></span>
<span id="cb444-9"><a href="graph-supported-hypos.html#cb444-9" tabindex="-1"></a><span class="co"># z: n draws of the binomial</span></span>
<span id="cb444-10"><a href="graph-supported-hypos.html#cb444-10" tabindex="-1"></a><span class="co"># with 2 trials and prob=0.5 </span></span>
<span id="cb444-11"><a href="graph-supported-hypos.html#cb444-11" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">2</span>, <span class="at">prob=</span><span class="fl">0.5</span>) </span>
<span id="cb444-12"><a href="graph-supported-hypos.html#cb444-12" tabindex="-1"></a></span>
<span id="cb444-13"><a href="graph-supported-hypos.html#cb444-13" tabindex="-1"></a><span class="co"># x: Gaussian with mean z</span></span>
<span id="cb444-14"><a href="graph-supported-hypos.html#cb444-14" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span>z, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb444-15"><a href="graph-supported-hypos.html#cb444-15" tabindex="-1"></a></span>
<span id="cb444-16"><a href="graph-supported-hypos.html#cb444-16" tabindex="-1"></a><span class="co"># y: Gaussian with mean 2*z</span></span>
<span id="cb444-17"><a href="graph-supported-hypos.html#cb444-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">2</span><span class="sc">*</span>z, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb444-18"><a href="graph-supported-hypos.html#cb444-18" tabindex="-1"></a></span>
<span id="cb444-19"><a href="graph-supported-hypos.html#cb444-19" tabindex="-1"></a><span class="co"># gather into a data table</span></span>
<span id="cb444-20"><a href="graph-supported-hypos.html#cb444-20" tabindex="-1"></a><span class="co"># we make z a factor for convenience with plotting functions</span></span>
<span id="cb444-21"><a href="graph-supported-hypos.html#cb444-21" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb444-22"><a href="graph-supported-hypos.html#cb444-22" tabindex="-1"></a>    x,y, </span>
<span id="cb444-23"><a href="graph-supported-hypos.html#cb444-23" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(<span class="st">&quot;z=&quot;</span>,z))</span>
<span id="cb444-24"><a href="graph-supported-hypos.html#cb444-24" tabindex="-1"></a>  )</span></code></pre></div>
<p>We check whether the simulations worked. First, <span class="math inline">\(z\)</span> distributes as expected with about 25% draws with 0 heads, 50% with one head, and 25% with 2 heads:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="graph-supported-hypos.html#cb445-1" tabindex="-1"></a><span class="fu">table</span>(z)</span></code></pre></div>
<pre><code>## z
##   0   1   2 
## 244 506 250</code></pre>
<p>Second, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> depend on <span class="math inline">\(z\)</span>:</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="graph-supported-hypos.html#cb447-1" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x=</span>z, <span class="at">y=</span>x)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-255-1.png" width="384" /></p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="graph-supported-hypos.html#cb448-1" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x=</span>z, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-256-1.png" width="384" /></p>
<p>As a consequence, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> correlate with each other:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="graph-supported-hypos.html#cb449-1" tabindex="-1"></a><span class="co"># You can pick different formulae in geom_smooth</span></span>
<span id="cb449-2"><a href="graph-supported-hypos.html#cb449-2" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-257-1.png" width="384" /></p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="graph-supported-hypos.html#cb450-1" tabindex="-1"></a><span class="fu">cor</span>(x,y)</span></code></pre></div>
<pre><code>## [1] 0.4535741</code></pre>
<p>This correlation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is due to the common cause <span class="math inline">\(z\)</span>. To show evidence for this issue, one can plot stratified by the values of <span class="math inline">\(z\)</span>. In each group, there is no association between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="graph-supported-hypos.html#cb452-1" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>z) <span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-259-1.png" width="1152" /></p>
<p>Moreover, one can compute the correlation also stratified by the value of <span class="math inline">\(z\)</span>. We see that in each group the correlation is near 0.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="graph-supported-hypos.html#cb453-1" tabindex="-1"></a>dt[, .(<span class="at">correlation=</span><span class="fu">cor</span>(x,y)), by<span class="ot">=</span>z]</span></code></pre></div>
<pre><code>##      z   correlation
## 1: z=2 -0.0005907227
## 2: z=1  0.0457336976
## 3: z=0 -0.0107107309</code></pre>
<p>In our simulation, conditioning on a third variable has ruled out direct correlation and, therefore, causation. Statistically speaking, we can state that the two variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> <em>are</em> correlated, but their correlation is explained by <span class="math inline">\(z\)</span>. Conditioned on <span class="math inline">\(z\)</span>, their correlation is basically zero. This rules out a causal relationship from one to the other. Correlation never proves causation. However, conditioning can rule out causation.</p>
</div>
<div id="indirect-association" class="section level4 hasAnchor" number="6.2.3.2">
<h4><span class="header-section-number">6.2.3.2</span> Indirect association<a href="graph-supported-hypos.html#indirect-association" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We now simulate the case of an indirect association. To this end we consider the following process:</p>
<ol style="list-style-type: decimal">
<li>We toss a coin once. We record <span class="math inline">\(x=1\)</span> if it is a head, and <span class="math inline">\(x=0\)</span> if it is a tail.</li>
<li>If <span class="math inline">\(x=0\)</span>, we toss the coin once. If <span class="math inline">\(x=1\)</span>, we toss the coins twice. We record <span class="math inline">\(z\)</span>, the number of heads of this second step.</li>
<li>We draw a value <span class="math inline">\(y\)</span> randomly according to a Gaussian distribution with mean equal to <span class="math inline">\(z\)</span> and standard deviation 0.5. Hence, <span class="math inline">\(y\)</span> will be a random real number that tend to have higher values with higher values of <span class="math inline">\(z\)</span>.</li>
</ol>
<p>The following R code simulates such data:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="graph-supported-hypos.html#cb455-1" tabindex="-1"></a><span class="co"># first step:  tossing a coin once</span></span>
<span id="cb455-2"><a href="graph-supported-hypos.html#cb455-2" tabindex="-1"></a><span class="co"># record x=1 if head, x=0 if tail.</span></span>
<span id="cb455-3"><a href="graph-supported-hypos.html#cb455-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span>
<span id="cb455-4"><a href="graph-supported-hypos.html#cb455-4" tabindex="-1"></a></span>
<span id="cb455-5"><a href="graph-supported-hypos.html#cb455-5" tabindex="-1"></a><span class="co"># second step</span></span>
<span id="cb455-6"><a href="graph-supported-hypos.html#cb455-6" tabindex="-1"></a><span class="co"># if x=0, toss the coin once, if x=1, toss the coins twice</span></span>
<span id="cb455-7"><a href="graph-supported-hypos.html#cb455-7" tabindex="-1"></a><span class="co"># record z the number of heads of this second step. </span></span>
<span id="cb455-8"><a href="graph-supported-hypos.html#cb455-8" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size=</span>x<span class="sc">+</span><span class="dv">1</span>, <span class="at">prob=</span><span class="fl">0.5</span>) </span>
<span id="cb455-9"><a href="graph-supported-hypos.html#cb455-9" tabindex="-1"></a></span>
<span id="cb455-10"><a href="graph-supported-hypos.html#cb455-10" tabindex="-1"></a><span class="do">## y: Gaussian with mean=z</span></span>
<span id="cb455-11"><a href="graph-supported-hypos.html#cb455-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span>z, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb455-12"><a href="graph-supported-hypos.html#cb455-12" tabindex="-1"></a></span>
<span id="cb455-13"><a href="graph-supported-hypos.html#cb455-13" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb455-14"><a href="graph-supported-hypos.html#cb455-14" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(<span class="st">&quot;x=&quot;</span>,x)),</span>
<span id="cb455-15"><a href="graph-supported-hypos.html#cb455-15" tabindex="-1"></a>  y, </span>
<span id="cb455-16"><a href="graph-supported-hypos.html#cb455-16" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(<span class="st">&quot;z=&quot;</span>,z))</span>
<span id="cb455-17"><a href="graph-supported-hypos.html#cb455-17" tabindex="-1"></a>)</span></code></pre></div>
<p>We see that <span class="math inline">\(y\)</span> associates with <span class="math inline">\(x\)</span>:</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="graph-supported-hypos.html#cb456-1" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-262-1.png" width="384" /></p>
<p>However this association vanishes when we condition on <span class="math inline">\(z\)</span>:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="graph-supported-hypos.html#cb457-1" tabindex="-1"></a><span class="do">## y does not associate with x given z</span></span>
<span id="cb457-2"><a href="graph-supported-hypos.html#cb457-2" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>z)</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-263-1.png" width="1152" /></p>
<p>Conditioning on the third variable has helped ruling out a direct causal relation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Note, however, that in this simulation there is an indirect causal relation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. From an observational data point of view, the situation is very similar to the common cause situation. Interpretations from the application field are needed to suggest whether such data supports an indirect association or a common cause.</p>
<p>A concrete example of an indirect association is provided by Rafael Irizzary in his book “Introduction to Data Science” which we reproduce in the following.</p>
<p>For this, we consider the admission data from six U.C. Berkeley majors on 1973. The data shows at first sight that more men were being admitted than women: 44% men were admitted compared to 30% women. We can load the data and compute the percent of men and women that were accepted like this:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="graph-supported-hypos.html#cb458-1" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb458-2"><a href="graph-supported-hypos.html#cb458-2" tabindex="-1"></a><span class="fu">data</span>(admissions)</span>
<span id="cb458-3"><a href="graph-supported-hypos.html#cb458-3" tabindex="-1"></a>admissions <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(admissions)</span>
<span id="cb458-4"><a href="graph-supported-hypos.html#cb458-4" tabindex="-1"></a>admissions[, <span class="fu">sum</span>(admitted<span class="sc">*</span>applicants)<span class="sc">/</span><span class="fu">sum</span>(applicants), by<span class="ot">=</span>gender]</span></code></pre></div>
<pre><code>##    gender       V1
## 1:    men 44.51951
## 2:  women 30.33351</code></pre>
<p>Closer inspection shows a paradoxical result. Here are the percent admissions by major:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="graph-supported-hypos.html#cb460-1" tabindex="-1"></a>stats <span class="ot">&lt;-</span> admissions[, <span class="fu">c</span>(<span class="st">&#39;major&#39;</span>, <span class="st">&#39;gender&#39;</span>, <span class="st">&#39;admitted&#39;</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb460-2"><a href="graph-supported-hypos.html#cb460-2" tabindex="-1"></a>  <span class="fu">dcast</span>(...<span class="sc">~</span>gender, <span class="at">value.var=</span><span class="st">&#39;admitted&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb460-3"><a href="graph-supported-hypos.html#cb460-3" tabindex="-1"></a>    .[, women_minus_men <span class="sc">:=</span> women <span class="sc">-</span> men]</span>
<span id="cb460-4"><a href="graph-supported-hypos.html#cb460-4" tabindex="-1"></a><span class="fu">head</span>(stats)</span></code></pre></div>
<pre><code>##    major men women women_minus_men
## 1:     A  62    82              20
## 2:     B  63    68               5
## 3:     C  37    34              -3
## 4:     D  33    35               2
## 5:     E  28    24              -4
## 6:     F   6     7               1</code></pre>
<p>Four out of the six majors favor women. More importantly, all the differences are much smaller than the 14.2 difference that we see when examining the totals.</p>
<p>The paradox is that analyzing the totals suggests a dependence between admission and gender, but when the data is grouped by major, this dependence seems to disappear. What’s going on? This actually can happen if an uncounted confounder is driving most of the variability.</p>
<p>We define three variables: <span class="math inline">\(X\)</span> is 1 for men and 0 for women, <span class="math inline">\(Y\)</span> is 1 for those admitted and 0 otherwise, and <span class="math inline">\(Z\)</span> quantifies the selectivity of the major. A gender bias claim would be based on the fact that <span class="math inline">\(\mbox{Pr}(Y=1 | X = x)\)</span> is higher for <span class="math inline">\(x=1\)</span> than <span class="math inline">\(x=0\)</span>. However, <span class="math inline">\(Z\)</span> is an important confounder to consider. Clearly <span class="math inline">\(Z\)</span> is associated with <span class="math inline">\(Y\)</span>, as the more selective a major, the lower <span class="math inline">\(\mbox{Pr}(Y=1 | Z = z)\)</span>. But is major selectivity <span class="math inline">\(Z\)</span> associated with gender <span class="math inline">\(X\)</span>?</p>
<p>One way to see this is to plot the total percent admitted to a major versus the percent of women that made up the applicants:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="graph-supported-hypos.html#cb462-1" tabindex="-1"></a>admissions <span class="sc">%&gt;%</span> </span>
<span id="cb462-2"><a href="graph-supported-hypos.html#cb462-2" tabindex="-1"></a>  .[, .(<span class="fu">sum</span>(admitted <span class="sc">*</span> applicants)<span class="sc">/</span><span class="fu">sum</span>(applicants),</span>
<span id="cb462-3"><a href="graph-supported-hypos.html#cb462-3" tabindex="-1"></a>        <span class="fu">sum</span>(applicants <span class="sc">*</span> (gender<span class="sc">==</span><span class="st">&quot;women&quot;</span>)) <span class="sc">/</span><span class="fu">sum</span>(applicants) <span class="sc">*</span> <span class="dv">100</span>), by<span class="ot">=</span>major] <span class="sc">%&gt;%</span></span>
<span id="cb462-4"><a href="graph-supported-hypos.html#cb462-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(V1, V2, <span class="at">label =</span> major)) <span class="sc">+</span></span>
<span id="cb462-5"><a href="graph-supported-hypos.html#cb462-5" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Major Selectivity&#39;</span>, <span class="at">y=</span><span class="st">&#39;Percent Women Applicants&#39;</span>) <span class="sc">+</span> mytheme</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/uc-berkeley-majors-1.png" width="672" /></p>
<p>There seems to be association. The plot suggests that women were much more likely to apply to the two “hard” majors: gender and major’s selectivity are confounded. Compare, for example, major B and major E. Major E is much harder to enter than major B and over 60% of applicants to major E were women, while less than 30% of the applicants of major B were women.</p>
<p>The following plot shows the number of applicants that were admitted and those that were not by gender and major:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="graph-supported-hypos.html#cb463-1" tabindex="-1"></a>admissions_plot <span class="ot">&lt;-</span> admissions[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">yes =</span> <span class="fu">round</span>(admitted<span class="sc">/</span><span class="dv">100</span><span class="sc">*</span>applicants), </span>
<span id="cb463-2"><a href="graph-supported-hypos.html#cb463-2" tabindex="-1"></a>                <span class="at">no =</span> <span class="fu">round</span>(applicants <span class="sc">-</span> admitted<span class="sc">/</span><span class="dv">100</span><span class="sc">*</span>applicants )),</span>
<span id="cb463-3"><a href="graph-supported-hypos.html#cb463-3" tabindex="-1"></a>           by<span class="ot">=</span>.(major, gender)] <span class="sc">%&gt;%</span></span>
<span id="cb463-4"><a href="graph-supported-hypos.html#cb463-4" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">measure.vars=</span><span class="fu">c</span>(<span class="st">&#39;yes&#39;</span>, <span class="st">&#39;no&#39;</span>), <span class="at">value.name=</span><span class="st">&#39;number_of_students&#39;</span>,</span>
<span id="cb463-5"><a href="graph-supported-hypos.html#cb463-5" tabindex="-1"></a>       <span class="at">variable.name=</span><span class="st">&#39;admission&#39;</span>) </span>
<span id="cb463-6"><a href="graph-supported-hypos.html#cb463-6" tabindex="-1"></a></span>
<span id="cb463-7"><a href="graph-supported-hypos.html#cb463-7" tabindex="-1"></a><span class="fu">ggplot</span>(admissions_plot, <span class="fu">aes</span>(gender, number_of_students, <span class="at">fill =</span> admission)) <span class="sc">+</span></span>
<span id="cb463-8"><a href="graph-supported-hypos.html#cb463-8" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb463-9"><a href="graph-supported-hypos.html#cb463-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> major)</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-266-1.png" width="672" /></p>
<p>The visualization breaks down the acceptances by major. This breakdown allows us to see that the majority of accepted men came from two majors: A and B. It also lets us see that few women applied to these majors.</p>
<p>Changing the position to <code>"fill"</code> in <code>geom_bar()</code> returns the following plot:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="graph-supported-hypos.html#cb464-1" tabindex="-1"></a><span class="fu">ggplot</span>(admissions_plot, <span class="fu">aes</span>(gender, number_of_students, <span class="at">fill =</span> admission)) <span class="sc">+</span></span>
<span id="cb464-2"><a href="graph-supported-hypos.html#cb464-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-3"><a href="graph-supported-hypos.html#cb464-3" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;proportion admitted&quot;</span>) <span class="sc">+</span></span>
<span id="cb464-4"><a href="graph-supported-hypos.html#cb464-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> major)</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-267-1.png" width="672" /></p>
<p>Setting <code>"fill"</code> as the position argument makes each set of stacked bars to have the same height. This makes it easier to compare proportions across groups. However, note that it can be hard to compare some groups with increasing number of stacked bars.</p>
<p>Altogether, this data suggests the following causal interpretation:</p>
<p><span class="math inline">\(\text{Gender} \rightarrow \text{Major} \rightarrow \text{Admission}\)</span></p>
<p>In this interpretation of this data, women are proportionally less admitted because they choose more selective majors. Hence the association is correct, causal, in the right orientation, but it is indirect.</p>
</div>
<div id="common-consequence" class="section level4 hasAnchor" number="6.2.3.3">
<h4><span class="header-section-number">6.2.3.3</span> Common consequence<a href="graph-supported-hypos.html#common-consequence" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The last elementary situation is the case where the third variable is a common consequence.
One fun imaginary example is given by Judea Pearl in “The Book of Why” <a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> about talent and beauty among Hollywood stars.</p>
<p>We assume that:</p>
<ul>
<li>Talent for acting is a quantitative value that is randomly distributed among the human population.</li>
<li>Beauty is a quantitative value <span class="math inline">\(y\)</span> randomly distributed among the human population and independently of talent for acting.</li>
<li>Hollywood stars must have talent for acting and beauty or be very beautiful or very good actors.</li>
</ul>
<p>We can use the computer to simulate such a situation as:</p>
<ul>
<li>draw <span class="math inline">\(x\)</span> with a Gaussian of mean 0 and standard deviation 1</li>
<li>draw <span class="math inline">\(y\)</span> with a Gaussian of mean 0 and standard deviation 1 independently of <span class="math inline">\(x\)</span></li>
<li>let <span class="math inline">\(z=1\)</span> if <span class="math inline">\(x+y&gt;1\)</span></li>
</ul>
<p>The following code simulates such data:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="graph-supported-hypos.html#cb465-1" tabindex="-1"></a><span class="do">#############</span></span>
<span id="cb465-2"><a href="graph-supported-hypos.html#cb465-2" tabindex="-1"></a><span class="do">## common consequence x-&gt;z&lt;-y</span></span>
<span id="cb465-3"><a href="graph-supported-hypos.html#cb465-3" tabindex="-1"></a><span class="do">#############</span></span>
<span id="cb465-4"><a href="graph-supported-hypos.html#cb465-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)  <span class="co"># talent for acting</span></span>
<span id="cb465-5"><a href="graph-supported-hypos.html#cb465-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)  <span class="co"># beauty</span></span>
<span id="cb465-6"><a href="graph-supported-hypos.html#cb465-6" tabindex="-1"></a>z <span class="ot">&lt;-</span> x<span class="sc">+</span>y <span class="sc">&gt;</span> <span class="dv">1</span>  </span>
<span id="cb465-7"><a href="graph-supported-hypos.html#cb465-7" tabindex="-1"></a></span>
<span id="cb465-8"><a href="graph-supported-hypos.html#cb465-8" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(x, y, z)</span></code></pre></div>
<p>In our simulated population, beauty and talent for acting do not correlate:</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="graph-supported-hypos.html#cb466-1" tabindex="-1"></a><span class="do">## x and y do not associate</span></span>
<span id="cb466-2"><a href="graph-supported-hypos.html#cb466-2" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Talent for acting&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Beauty&#39;</span>)</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-269-1.png" width="384" /></p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="graph-supported-hypos.html#cb467-1" tabindex="-1"></a><span class="fu">cor</span>(x,y)</span></code></pre></div>
<pre><code>## [1] -0.03192247</code></pre>
<p>The fun paradox comes when we restrict our analysis to the Hollywood stars:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="graph-supported-hypos.html#cb469-1" tabindex="-1"></a><span class="do">## x associates with y when z is TRUE</span></span>
<span id="cb469-2"><a href="graph-supported-hypos.html#cb469-2" tabindex="-1"></a><span class="fu">ggplot</span>(dt[z <span class="sc">==</span> <span class="cn">TRUE</span>], <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Talent for acting&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Beauty&#39;</span>)</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-270-1.png" width="384" /></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="graph-supported-hypos.html#cb470-1" tabindex="-1"></a>dt[z, <span class="fu">cor</span>(x,y)]</span></code></pre></div>
<pre><code>## [1] -0.5843082</code></pre>
<p>Hence, beautiful Hollywood stars tend to act worse than than less beautiful stars.</p>
<p>This paradox is known as Berkson’s paradox <a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>. Berkson originally reported the paradox on patient data collected in a hospital. As these patients are in the hospital because they are sick, risk factors for their diseases, which do not correlate in the general population, happen to negatively correlate among them. Studies based on hospital data only can suffer from such bias.</p>
<p>Altogether, the association arises once we condition on the third variable. This has two implications. First, conditioning should not be done systematically. Second, the data may already be conditioned and we are not aware of it! The data may have undergone some filtering during data analysis, or, less obviously, during data collection. Those possibilities should be considered when reporting associations between variables.</p>
</div>
</div>
<div id="simpsons-paradox" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Simpson’s paradox<a href="graph-supported-hypos.html#simpsons-paradox" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In 1951, Simpson demonstrated that a statistical relationship observed within a group of individuals could be reversed within all subgroups that make up that population. This phenomenon, where a variable X seems to relate to a second variable Y in a certain way, but flips direction when the stratifying for another variable Z, has since been referred to as Simpson’s paradox.</p>
<div class="figure"><span style="display:block;" id="fig:simpson-paradox"></span>
<img src="assets/img/lec06_simpson_paradox.png" alt="Simpson's paradox. The sign (+ or -) designates positive or negative effects (causal diagram, left) or associations (right)." width="500px" />
<p class="caption">
Figure 6.4: Simpson’s paradox. The sign (+ or -) designates positive or negative effects (causal diagram, left) or associations (right).
</p>
</div>
<p>We simulate a dataset for illustrating the Simpson’s paradox with the help of the function <code>simulate_simpson()</code> from the library <code>correlation</code>:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="graph-supported-hypos.html#cb472-1" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;easystats/correlation&quot;)</span></span>
<span id="cb472-2"><a href="graph-supported-hypos.html#cb472-2" tabindex="-1"></a><span class="fu">library</span>(correlation)</span>
<span id="cb472-3"><a href="graph-supported-hypos.html#cb472-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">simulate_simpson</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">groups =</span> <span class="dv">4</span>, <span class="at">r =</span> <span class="fl">0.6</span>) <span class="sc">%&gt;%</span> as.data.table</span>
<span id="cb472-4"><a href="graph-supported-hypos.html#cb472-4" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;X&#39;</span>, <span class="st">&#39;Y&#39;</span>, <span class="st">&#39;Z&#39;</span>)</span>
<span id="cb472-5"><a href="graph-supported-hypos.html#cb472-5" tabindex="-1"></a>data</span></code></pre></div>
<pre><code>##              X          Y   Z
##   1: 0.7571442 -0.2531470 G_1
##   2: 1.3253338  0.2617510 G_1
##   3: 1.1057654 -1.0828252 G_1
##   4: 0.1859743 -0.3760158 G_1
##   5: 2.1004333  1.5311882 G_1
##  ---                         
## 396: 3.3302676 -3.4945929 G_4
## 397: 3.3872684 -4.4615286 G_4
## 398: 2.4995125 -4.9025445 G_4
## 399: 3.7237566 -4.7194693 G_4
## 400: 4.3878277 -3.5184049 G_4</code></pre>
<p>When visualizing the relationship between the variables <code>X</code> and <code>Y</code>, we observe a negative correlation between <code>X</code> and <code>Y</code>:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="graph-supported-hypos.html#cb474-1" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(X,Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>) <span class="sc">+</span> mytheme</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-272-1.png" width="672" /></p>
<p>However, when grouping by the variable Z, we observe a positive correlation which is the opposite direction as before:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="graph-supported-hypos.html#cb475-1" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb475-2"><a href="graph-supported-hypos.html#cb475-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Z)) <span class="sc">+</span></span>
<span id="cb475-3"><a href="graph-supported-hypos.html#cb475-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Z), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb475-4"><a href="graph-supported-hypos.html#cb475-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> mytheme</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-273-1.png" width="672" /></p>
<!-- https://paulvanderlaken.com/2017/09/27/simpsons-paradox-two-hr-examples-with-r-code/ -->
<!-- https://rpubs.com/shampjeff/blog_post_2 -->
</div>
</div>
<div id="data-presentation-as-story-telling" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Data presentation as story telling<a href="graph-supported-hypos.html#data-presentation-as-story-telling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data presentation plays an essential role in every field from academic studies to professional practices. However, it is often underestimated. Sometimes people work really hard on what they aim to present but fail to present it properly. The actual output of the analysis performed is almost singularly responsible for giving the message we want to give to the audience. For this, we have to first really understand who our audience is considering its background and interests.</p>
<p>After spending some time reflecting on the audience, we want to be able to present the data and its analysis clearly and efficiently. We want to create a good presentation that, like a good story, is easy to understand, has a clear message and is exciting.</p>
<div id="what-is-a-story" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> What is a story?<a href="graph-supported-hypos.html#what-is-a-story" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before discussing strategies for turning visualizations into stories, we have to understand what a story actually is. A story is a set of observations, facts, or events, that are presented in a specific order such that they create an emotional reaction in the audience. The emotional reaction is created through the build-up of tension at the beginning of the story followed by some type of resolution towards the end of the story. We refer to the flow from tension to resolution also as the story arc, and every good story has a clear, identifiable arc.</p>
<p>Commonly, a story teller first introduces the topic, then presents the challenge followed by a series of actions. Finally, the resolution is presented.</p>
</div>
<div id="presentation-structure" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Presentation structure<a href="graph-supported-hypos.html#presentation-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- - Introduction: motivation, background and goals -->
<!-- - Main: hypotheses/claims/results supported by a plot -->
<!-- - Closure: summary, conclusion and outlook -->
<p>Usually, a presentation is clearly divided into three main elements just like a good story: an introduction, a central part, and a closure.</p>
<div id="introduction-2" class="section level4 hasAnchor" number="6.3.2.1">
<h4><span class="header-section-number">6.3.2.1</span> Introduction<a href="graph-supported-hypos.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A presentation should have an introduction which clearly states the motivation to the topic, gives an overview on the background needed to understand the data and finally states the goals of the presentation. The open questions should be formulated here. What is not yet known or unclear in the field that your analysis addresses?</p>
</div>
<div id="development" class="section level4 hasAnchor" number="6.3.2.2">
<h4><span class="header-section-number">6.3.2.2</span> Development<a href="graph-supported-hypos.html#development" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The central part of the presentation is all about transforming hypotheses, claims and results into slides.</p>
<p>Two common misconceptions have to be avoided when presenting visualizations in a presentation. First, that the audience can see our figures and immediately infer the points we are trying to make. Second, that the audience can rapidly process complex visualizations and understand the key trends and relationships that are shown. We need to do everything we can to help our audience understands the meaning of our visualizations and see the same patterns in the data that we see. This usually means “less is more”.</p>
<p>Sometimes, however, we do want to show more complex figures that contain a large amount of information at once. In those cases, we can make things easier for our audience if we first show a simplified version of the figure before we show the final one in its full complexity.</p>
<p>Usually, we first show descriptive plots to first present the data and let the audience be able to understand the data. Then, we use associative plots to support claims, results and hypotheses.</p>
<p>Ideally, one slide contains exactly one claim supported by one plot. For this, the plot type should be chosen carefully. The title of the slide or figure is a very important element. The title should give the take-home message of the presented visualizations. It is a clear and simple interpretation of the plot. For instance, a title such as “Scatterplot of diamond price versus carat” for Figure <a href="graph-supported-hypos.html#fig:price-vs-carat">6.1</a> would not be informative since it is evident from the type of the plot and the axis labels that we look at a scatter plot of price versus carat. More informative is your interpretation of it, which the reader can judge from the plot. Do you want to claim that “Price increases nearly linearly with carat”, or rather that “There remains much price variation among diamonds with the same carat”? Such statements make informative slide titles.</p>
</div>
<div id="closure" class="section level4 hasAnchor" number="6.3.2.3">
<h4><span class="header-section-number">6.3.2.3</span> Closure<a href="graph-supported-hypos.html#closure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The presentation should ideally have a strong closure. We can usually start with a summary of the presentation including a clear conclusion. With the conclusion, the audience should be able to answer the fundamental question: what do we learn from the presented data analysis? The conclusions typically correspond to the open questions formulated in the introduction. Often, an outlook containing possible next steps can be briefly summarized at the end of a presentation.</p>
</div>
</div>
</div>
<div id="guidelines-for-coloring-in-data-visualization" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Guidelines for coloring in data visualization<a href="graph-supported-hypos.html#guidelines-for-coloring-in-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Colors are an effective and powerful medium for communicating meaning. In data visualization, color sets the tone and enforces a message for the underlying visual display.</p>
<div id="color-coding-in-r" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Color coding in R<a href="graph-supported-hypos.html#color-coding-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Basically, there are four options for color coding with <code>ggplot2</code> in R:</p>
<ol style="list-style-type: decimal">
<li>Using default colors</li>
<li>Explicitly setting color names (e.g. “red”, “blue”)</li>
<li>Explicitly setting RGB or HTML color codes (e.g. 00-FF)</li>
<li>Explicitly setting color palettes</li>
</ol>
<div id="color-palettes" class="section level4 hasAnchor" number="6.4.1.1">
<h4><span class="header-section-number">6.4.1.1</span> Color palettes<a href="graph-supported-hypos.html#color-palettes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The package <code>RColorBrewer</code> provides a comprehensive set of nice color palettes:</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="graph-supported-hypos.html#cb476-1" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb476-2"><a href="graph-supported-hypos.html#cb476-2" tabindex="-1"></a><span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="assets/img/palettess.png" width="200px" /></p>
<p>Generally, we use sequential palettes for continuous variables to show quantitative differences:</p>
<p><img src="assets/img/lec07_col_seq_pal.png" width="200px" /></p>
<p>We use qualitative palettes for categorical variables to separate items into distinct groups and we use diverging palettes for numeric variables that have a meaningful central value or breakout point (e.g. 0).</p>
<p><img src="assets/img/lec07_col_div_pal.png" width="200px" /></p>
</div>
</div>
<div id="general-rules-for-color-coding" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> General rules for color coding<a href="graph-supported-hypos.html#general-rules-for-color-coding" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Even though color coding can be very helpful in several visualizations, it has to be used with precaution. Like all aspects of visual perception, we do not perceive color in an absolute manner. Perception of an object is influenced by the context. Hence, visual perception is relative, not absolute.</p>
<p><strong>Rule #1: consistent background</strong></p>
<p>If we want different objects of the same color in a table or graph to look the same, we have to make sure that the background is consistent.</p>
<p>In the following example, the squares seem to have a different color but they actually don’t. The background makes it hard to compare them.</p>
<p><img src="assets/img/lec07_col_contrast.png" width="500px" /></p>
<p><strong>Rule #2: sufficient contrast for visibility</strong></p>
<p>If we want objects in a table or graph to be easily seen, we need to use a background color that contrasts sufficiently with the object that we want to visualize.</p>
<p><strong>Rule #3: meaningful color usage</strong></p>
<p>We use color coding only when we really need it to serve a particular communication goal.</p>
<p>In the following example, the added colors provide no additional information:</p>
<p><img src="dataviz_book_files/figure-html/unnamed-chunk-279-1.png" width="480" /></p>
<p><strong>Rule #4: color usage with restraint</strong></p>
<p>We use different colors only when they correspond to differences of meaning in the data.</p>
<p><strong>Rule #5: less is more</strong></p>
<p>Use soft, natural colors to display most information and bright and/or dark colors to highlight only particular information that requires greater attention.</p>
</div>
</div>
<div id="general-dos-and-donts-in-data-visualization" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> General do’s and don’ts in data visualization<a href="graph-supported-hypos.html#general-dos-and-donts-in-data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="dos" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Do’s<a href="graph-supported-hypos.html#dos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Keep visualizations simple</strong></p>
<p>Keeping simple visualizations is probably the most important guideline. Often people assume that complex plots are useful visualizations, while the opposite is actually true. Good plots should have simple messages and make the visualized data as easy to understand as possible. A visualization should be effective and simple. Do not try to present too much information.</p>
<p><strong>Have meaningful and expressive titles</strong></p>
<p>Figure title (or slide tile) states the finding (what do we observe?) and not the methods (how do you do it?). For example a good title is “The further away an airport, the longer the flight” instead of “Scatter-plotting air time and distance”.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="graph-supported-hypos.html#cb477-1" tabindex="-1"></a>flightsLAX <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&#39;extdata/casestudy1/flightsLAX.csv&#39;</span>)</span>
<span id="cb477-2"><a href="graph-supported-hypos.html#cb477-2" tabindex="-1"></a><span class="fu">ggplot</span>(flightsLAX, <span class="fu">aes</span>(DISTANCE, AIR_TIME)) <span class="sc">+</span> </span>
<span id="cb477-3"><a href="graph-supported-hypos.html#cb477-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb477-4"><a href="graph-supported-hypos.html#cb477-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&#39;lm&#39;</span>) <span class="sc">+</span> </span>
<span id="cb477-5"><a href="graph-supported-hypos.html#cb477-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;The further away an airport, the longer the flight&#39;</span>) <span class="sc">+</span> mytheme</span></code></pre></div>
<p><img src="dataviz_book_files/figure-html/artist-1.png" width="500px" /></p>
<p><strong>Always label the axes</strong></p>
<p>Axes, colors, and shapes should be labelled. All labels should be legible for the audience (big fonts).</p>
<!-- **Use meaningful colors only when needed** -->
<!-- As stated before, we want to be careful with colors. Only use them when needed and be conscious about their meaning. Minimize the danger of distraction when too many colors are used.  -->
<p><strong>Always keep the goal of the visualization on mind</strong></p>
<p>Always think about the message that needs to be reported with the visualization. What is the goal? Focus on the story and the claims or conclusions you want to make.</p>
<p><strong>Know when to include 0</strong></p>
<p>When using barplots, it is typically dishonest not to start the bars at 0. This is because, by using a barplot, we are implying the length is proportional to the quantities being displayed. By avoiding 0, relatively small differences can be made to look much bigger than they actually are. This approach is often used by politicians or media organizations trying to exaggerate a difference.</p>
<p>We can have a look at this illustrative example:</p>
<p><img src="assets/img/chart_junk.jpg" width="500px" /></p>
<p>The plot was shown by Fox News (<a href="http://mediamatters.org/blog/2013/04/05/fox-news-newest-dishonest-chart-immigration-enf/193507" class="uri">http://mediamatters.org/blog/2013/04/05/fox-news-newest-dishonest-chart-immigration-enf/193507</a>).
From the plot above, it appears that apprehensions have almost tripled, when in fact they have only increased by about 16%. Starting the graph at 0 illustrates this clearly:</p>
<p><img src="dataviz_book_files/figure-html/lec07_include0-1.png" width="384" /></p>
</div>
<div id="donts" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Don’ts<a href="graph-supported-hypos.html#donts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Good plotting style is like good writing style: say the most with the least. We can here quote Antoine de Saint-Exupery:</p>
<p><em>“Perfection is achieved not when there is nothing more to add, but when there is nothing left to take away”.</em></p>
<p>The concept of <em>data-ink ratio</em> is therefore useful to critically chose a visualization. In particular, visualizations that contain at least one the following criteria can be considered as chart junk and should be avoided:</p>
<ul>
<li>double encoding (color and axis encode the same)</li>
<li>heavy or dark grid lines</li>
<li>unnecessary text</li>
<li>ornamented chart axes</li>
<li>pictures within graphs</li>
<li>shading or pseudo 3D plots</li>
</ul>
<p>A good example of a transformation of a bad plot into a good plot can be obtained from: <a href="https://www.darkhorseanalytics.com/blog/data-looks-better-naked/" class="uri">https://www.darkhorseanalytics.com/blog/data-looks-better-naked/</a></p>
<p><strong>Avoid pseudo three-dimensional plots</strong></p>
<p>The figure below, taken from the scientific literature <a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> shows three variables: dose, drug type and survival. Although our screens are flat and two dimensional, the plot tries to imitate three dimensions and assigns a dimension to each variable.</p>
<p><img src="assets/fig/d3_plot.png" width="500px" /></p>
<p>However, humans are not good at seeing in three dimensions (which explains why it is hard to parallel park) and our limitation is even worse with pseudo-three-dimensions. To see this, we can try to determine the values of the survival variable in the plot above. Probably, we cannot really tell when the purple ribbon intersects the red one.</p>
<p>Instead, we can easily use color to represent the categorical variable to avoid the pseudo 3 dimensional construction:</p>
<p><img src="dataviz_book_files/figure-html/lec07_3d-1.png" width="384" /></p>
<p>This plot demonstrates that using color is more than enough to distinguish the three lines.</p>
<p><strong>Do not manipulate plots</strong></p>
<p>A good practice in data science is to be as honest as possible with the plots we create. Intentional manipulation is definitely a “don’t”.</p>
</div>
</div>
<div id="summary-4" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Summary<a href="graph-supported-hypos.html#summary-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By now, you should be able to:</p>
<ul>
<li><p>Distinguish exploratory figures showing data distributions, from associative figures</p></li>
<li><p>Know and mind the basic reasons for misleading associations:</p>
<ul>
<li>not robust</li>
<li>reverse causal direction</li>
<li>common cause</li>
<li>indirect effect</li>
<li>common consequence</li>
</ul></li>
<li><p>Mind data-ink ratio by showing more data and reducing decorations</p></li>
<li><p>Prepare your report to provide novel insights. The audience should be able to easily answer the question: “What did I learn?”</p></li>
</ul>
</div>
<div id="resources-2" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Resources<a href="graph-supported-hypos.html#resources-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p><a href="https://humansofdata.atlan.com/2019/02/dos-donts-data-visualization/" class="uri">https://humansofdata.atlan.com/2019/02/dos-donts-data-visualization/</a></p></li>
<li><p><a href="http://paldhous.github.io/ucb/2016/dataviz/week2.html" class="uri">http://paldhous.github.io/ucb/2016/dataviz/week2.html</a></p></li>
<li><p>Fundamentals of Data Visualization, Claus O. Wilke, <a href="https://clauswilke.com/dataviz/telling-a-story.html" class="uri">https://clauswilke.com/dataviz/telling-a-story.html</a></p></li>
<li><p>Introduction to Data Science, Rafael A. Irizarry, <a href="https://rafalab.github.io/dsbook/index.html" class="uri">https://rafalab.github.io/dsbook/index.html</a></p></li>
</ul>
<p>Advanced (proofs of conditional dependencies for the 3-variable elementary causal diagrams):</p>
<p>C. Bishop, Pattern Recognition and Machine Learning. <a href="https://www.microsoft.com/en-us/research/people/cmbishop/prml-book/" class="uri">https://www.microsoft.com/en-us/research/people/cmbishop/prml-book/</a></p>
<div style="page-break-after: always;"></div>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p><a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet" class="uri">https://en.wikipedia.org/wiki/Anscombe%27s_quartet</a><a href="graph-supported-hypos.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p><a href="https://opinionator.blogs.nytimes.com/2014/04/12/parental-involvement-is-overrated" class="uri">https://opinionator.blogs.nytimes.com/2014/04/12/parental-involvement-is-overrated</a><a href="graph-supported-hypos.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p><a href="http://bayes.cs.ucla.edu/WHY/" class="uri">http://bayes.cs.ucla.edu/WHY/</a><a href="graph-supported-hypos.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p><a href="https://en.wikipedia.org/wiki/Berkson%27s_paradox" class="uri">https://en.wikipedia.org/wiki/Berkson%27s_paradox</a><a href="graph-supported-hypos.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>DNA Fingerprinting: A Review of the Controversy Kathryn Roeder Statistical Science Vol. 9, No. 2 (May, 1994), pp. 222-247<a href="graph-supported-hypos.html#fnref13" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="high-dimensional-visualizations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resampling-stat.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
